<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>重要的 Elasticsearch 配置 | Elasticsearch 中文文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8380975615223941" crossorigin="anonymous"></script>
    <meta name="description" content="Elasticsearch 中文文档，基于 v7.11 官方文档开始翻译">
    <meta name="keywords" content="Elastic,Elasticsearch,ElasticStack,ELK,Document,docs,文档,中文文档,入门">
    
    <link rel="preload" href="/assets/css/0.styles.87a55001.css" as="style"><link rel="preload" href="/assets/js/app.f54b6f9f.js" as="script"><link rel="preload" href="/assets/js/2.c3078b94.js" as="script"><link rel="preload" href="/assets/js/121.3ad921c9.js" as="script"><link rel="prefetch" href="/assets/js/10.0268c297.js"><link rel="prefetch" href="/assets/js/100.9de07136.js"><link rel="prefetch" href="/assets/js/101.6b8f1eb5.js"><link rel="prefetch" href="/assets/js/102.40ae2247.js"><link rel="prefetch" href="/assets/js/103.15f45561.js"><link rel="prefetch" href="/assets/js/104.08813b13.js"><link rel="prefetch" href="/assets/js/105.072ab95d.js"><link rel="prefetch" href="/assets/js/106.5c4e70b8.js"><link rel="prefetch" href="/assets/js/107.7033c270.js"><link rel="prefetch" href="/assets/js/108.684c837a.js"><link rel="prefetch" href="/assets/js/109.c45629d4.js"><link rel="prefetch" href="/assets/js/11.2421a902.js"><link rel="prefetch" href="/assets/js/110.ecbd4962.js"><link rel="prefetch" href="/assets/js/111.60ec4b97.js"><link rel="prefetch" href="/assets/js/112.6d00c06a.js"><link rel="prefetch" href="/assets/js/113.cd021933.js"><link rel="prefetch" href="/assets/js/114.300acbcd.js"><link rel="prefetch" href="/assets/js/115.b42b7a52.js"><link rel="prefetch" href="/assets/js/116.5e3de158.js"><link rel="prefetch" href="/assets/js/117.b497aeca.js"><link rel="prefetch" href="/assets/js/118.c40d791b.js"><link rel="prefetch" href="/assets/js/119.15083082.js"><link rel="prefetch" href="/assets/js/12.7db7d3e7.js"><link rel="prefetch" href="/assets/js/120.93860c72.js"><link rel="prefetch" href="/assets/js/122.0aec2afd.js"><link rel="prefetch" href="/assets/js/123.3b3820d1.js"><link rel="prefetch" href="/assets/js/124.370c6e81.js"><link rel="prefetch" href="/assets/js/125.403d0704.js"><link rel="prefetch" href="/assets/js/126.18292c99.js"><link rel="prefetch" href="/assets/js/127.5e25a5ff.js"><link rel="prefetch" href="/assets/js/128.b4926d7e.js"><link rel="prefetch" href="/assets/js/129.5cfc0795.js"><link rel="prefetch" href="/assets/js/13.f7bd7d98.js"><link rel="prefetch" href="/assets/js/130.daed387b.js"><link rel="prefetch" href="/assets/js/131.11298c7e.js"><link rel="prefetch" href="/assets/js/132.3fa1e674.js"><link rel="prefetch" href="/assets/js/133.bf6623b7.js"><link rel="prefetch" href="/assets/js/134.5a756904.js"><link rel="prefetch" href="/assets/js/135.4ed99321.js"><link rel="prefetch" href="/assets/js/136.f474120f.js"><link rel="prefetch" href="/assets/js/137.0e230c25.js"><link rel="prefetch" href="/assets/js/14.2bcba9b1.js"><link rel="prefetch" href="/assets/js/15.9712105c.js"><link rel="prefetch" href="/assets/js/16.8ab752a5.js"><link rel="prefetch" href="/assets/js/17.6de20a2a.js"><link rel="prefetch" href="/assets/js/18.e504e957.js"><link rel="prefetch" href="/assets/js/19.208be713.js"><link rel="prefetch" href="/assets/js/20.2e9bdc63.js"><link rel="prefetch" href="/assets/js/21.d4a49a8b.js"><link rel="prefetch" href="/assets/js/22.0446ed10.js"><link rel="prefetch" href="/assets/js/23.a4fb764c.js"><link rel="prefetch" href="/assets/js/24.6c75ce3f.js"><link rel="prefetch" href="/assets/js/25.d670158f.js"><link rel="prefetch" href="/assets/js/26.03f10ce6.js"><link rel="prefetch" href="/assets/js/27.a37dedd5.js"><link rel="prefetch" href="/assets/js/28.27fa4b32.js"><link rel="prefetch" href="/assets/js/29.5ce688fe.js"><link rel="prefetch" href="/assets/js/3.f849e4bc.js"><link rel="prefetch" href="/assets/js/30.a951767b.js"><link rel="prefetch" href="/assets/js/31.349c7c0f.js"><link rel="prefetch" href="/assets/js/32.1560337b.js"><link rel="prefetch" href="/assets/js/33.47920c4a.js"><link rel="prefetch" href="/assets/js/34.019af1d9.js"><link rel="prefetch" href="/assets/js/35.4f48f0bf.js"><link rel="prefetch" href="/assets/js/36.dcadddfc.js"><link rel="prefetch" href="/assets/js/37.6168f6a2.js"><link rel="prefetch" href="/assets/js/38.b9973ed9.js"><link rel="prefetch" href="/assets/js/39.f676d7e9.js"><link rel="prefetch" href="/assets/js/4.b8adb022.js"><link rel="prefetch" href="/assets/js/40.6f283444.js"><link rel="prefetch" href="/assets/js/41.1bee86e3.js"><link rel="prefetch" href="/assets/js/42.ad482e2b.js"><link rel="prefetch" href="/assets/js/43.8b46d9cb.js"><link rel="prefetch" href="/assets/js/44.a3fe224e.js"><link rel="prefetch" href="/assets/js/45.b254769d.js"><link rel="prefetch" href="/assets/js/46.47ad3d4b.js"><link rel="prefetch" href="/assets/js/47.61da0555.js"><link rel="prefetch" href="/assets/js/48.23054156.js"><link rel="prefetch" href="/assets/js/49.1ccb0d07.js"><link rel="prefetch" href="/assets/js/5.ff5c5ea8.js"><link rel="prefetch" href="/assets/js/50.d9ebcadb.js"><link rel="prefetch" href="/assets/js/51.ed72c753.js"><link rel="prefetch" href="/assets/js/52.30faa61c.js"><link rel="prefetch" href="/assets/js/53.93256120.js"><link rel="prefetch" href="/assets/js/54.74850984.js"><link rel="prefetch" href="/assets/js/55.dd83a54b.js"><link rel="prefetch" href="/assets/js/56.5b6d142e.js"><link rel="prefetch" href="/assets/js/57.e57da23c.js"><link rel="prefetch" href="/assets/js/58.be41490d.js"><link rel="prefetch" href="/assets/js/59.080acdfe.js"><link rel="prefetch" href="/assets/js/6.ed3f2a05.js"><link rel="prefetch" href="/assets/js/60.e691b08c.js"><link rel="prefetch" href="/assets/js/61.7f9e8bc5.js"><link rel="prefetch" href="/assets/js/62.ee63803f.js"><link rel="prefetch" href="/assets/js/63.aae89af4.js"><link rel="prefetch" href="/assets/js/64.d247c52a.js"><link rel="prefetch" href="/assets/js/65.2ee8bba7.js"><link rel="prefetch" href="/assets/js/66.272b1339.js"><link rel="prefetch" href="/assets/js/67.066e8bdc.js"><link rel="prefetch" href="/assets/js/68.336efe2d.js"><link rel="prefetch" href="/assets/js/69.989b1eea.js"><link rel="prefetch" href="/assets/js/7.4a9e0db8.js"><link rel="prefetch" href="/assets/js/70.34beee4d.js"><link rel="prefetch" href="/assets/js/71.a3d541e7.js"><link rel="prefetch" href="/assets/js/72.b03d17a3.js"><link rel="prefetch" href="/assets/js/73.aa6f0650.js"><link rel="prefetch" href="/assets/js/74.68a87ef1.js"><link rel="prefetch" href="/assets/js/75.0e6785de.js"><link rel="prefetch" href="/assets/js/76.de95365c.js"><link rel="prefetch" href="/assets/js/77.14e67824.js"><link rel="prefetch" href="/assets/js/78.f79a8a2b.js"><link rel="prefetch" href="/assets/js/79.b2471459.js"><link rel="prefetch" href="/assets/js/8.13a80b3e.js"><link rel="prefetch" href="/assets/js/80.5112b96d.js"><link rel="prefetch" href="/assets/js/81.6b29f29e.js"><link rel="prefetch" href="/assets/js/82.20896295.js"><link rel="prefetch" href="/assets/js/83.13f55595.js"><link rel="prefetch" href="/assets/js/84.6c82c67a.js"><link rel="prefetch" href="/assets/js/85.4e171f21.js"><link rel="prefetch" href="/assets/js/86.de1f7aca.js"><link rel="prefetch" href="/assets/js/87.dc55c361.js"><link rel="prefetch" href="/assets/js/88.483af93d.js"><link rel="prefetch" href="/assets/js/89.1f89586e.js"><link rel="prefetch" href="/assets/js/9.0b2c6418.js"><link rel="prefetch" href="/assets/js/90.f2aa4c43.js"><link rel="prefetch" href="/assets/js/91.4314d8d8.js"><link rel="prefetch" href="/assets/js/92.494eccaf.js"><link rel="prefetch" href="/assets/js/93.0def2ee8.js"><link rel="prefetch" href="/assets/js/94.07681219.js"><link rel="prefetch" href="/assets/js/95.0a36c10d.js"><link rel="prefetch" href="/assets/js/96.f1f4aafe.js"><link rel="prefetch" href="/assets/js/97.c65f9c4f.js"><link rel="prefetch" href="/assets/js/98.dee248d7.js"><link rel="prefetch" href="/assets/js/99.018666f7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87a55001.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="Elasticsearch 中文文档" class="logo"> <span class="site-name can-hide">Elasticsearch 中文文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BookHub 首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://docs.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://pdf.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机书库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/dev2007/elasticsearch-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BookHub 首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://docs.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://pdf.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机书库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/dev2007/elasticsearch-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Elasticsearch 翻译说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#感谢与支持" class="sidebar-link">感谢与支持</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><a href="/intro" class="sidebar-heading clickable"><span>什么是 Elasticsearch？</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/getting_started" class="sidebar-heading clickable"><span>Elasticsearch 入门</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/set_up_elasticsearch" class="sidebar-heading clickable router-link-active open"><span>设置 Elasticsearch</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/set_up_elasticsearch/installing_elasticsearch/" class="sidebar-heading clickable"><span>安装 Elasticsearch</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/set_up_elasticsearch/configuring_elasticsearch" class="sidebar-heading clickable router-link-active open"><span>配置 Elasticsearch</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html" aria-current="page" class="active sidebar-link">重要的 Elasticsearch 配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#路径设置" class="sidebar-link">路径设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#多数据路径" class="sidebar-link">多数据路径</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#从多个数据路径迁移" class="sidebar-link">从多个数据路径迁移</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#集群名设置" class="sidebar-link">集群名设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#节点名设置" class="sidebar-link">节点名设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#网络主机设置" class="sidebar-link">网络主机设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#发现和集群构成设置" class="sidebar-link">发现和集群构成设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#堆大小设置" class="sidebar-link">堆大小设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#jvm-堆转储路径设置" class="sidebar-link">JVM 堆转储路径设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#gc-日志设置" class="sidebar-link">GC 日志设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#临时目录设置" class="sidebar-link">临时目录设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#jvm-致命错误日志设置" class="sidebar-link">JVM 致命错误日志设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration.html#集群备份" class="sidebar-link">集群备份</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/secure_settings.html" class="sidebar-link">安全设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/secure_settings.html#可重新加载的安全设置" class="sidebar-link">可重新加载的安全设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/auditing_settings.html" class="sidebar-link">审计安全设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/auditing_settings.html#常规审计设置" class="sidebar-link">常规审计设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/auditing_settings.html#审计事件设置" class="sidebar-link">审计事件设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/auditing_settings.html#本地节点信息设置" class="sidebar-link">本地节点信息设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/auditing_settings.html#审计日志文件事件忽略策略" class="sidebar-link">审计日志文件事件忽略策略</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html" class="sidebar-link">断路器设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#父断路器" class="sidebar-link">父断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#字段数据断路器" class="sidebar-link">字段数据断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#请求断路器" class="sidebar-link">请求断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#动态请求断路器" class="sidebar-link">动态请求断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#记账请求断路器" class="sidebar-link">记账请求断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#脚本编译断路器" class="sidebar-link">脚本编译断路器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/circuit_breaker_settings.html#正则断路器" class="sidebar-link">正则断路器</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html" class="sidebar-link">集群级分片分配和路由设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#集群级分片分配设置" class="sidebar-link">集群级分片分配设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#分片重平衡设置" class="sidebar-link">分片重平衡设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#分片平衡启发式设置" class="sidebar-link">分片平衡启发式设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#基于磁盘的分片分配设置" class="sidebar-link">基于磁盘的分片分配设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#分片分配感知" class="sidebar-link">分片分配感知</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#启用分片分配感知" class="sidebar-link">启用分片分配感知</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#强制感知" class="sidebar-link">强制感知</a></li></ul></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#集群级分片分配筛选" class="sidebar-link">集群级分片分配筛选</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#集群路由设置" class="sidebar-link">集群路由设置</a></li></ul></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#杂项集群级设置" class="sidebar-link">杂项集群级设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#元数据" class="sidebar-link">元数据</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#集群分片限制" class="sidebar-link">集群分片限制</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#用户定义的集群元数据" class="sidebar-link">用户定义的集群元数据</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#索引墓碑" class="sidebar-link">索引墓碑</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#日志器" class="sidebar-link">日志器</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings.html#持久性任务分配" class="sidebar-link">持久性任务分配</a></li></ul></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/cross_cluster_replication_settings.html" class="sidebar-link">跨集群复制设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cross_cluster_replication_settings.html#远程恢复设置" class="sidebar-link">远程恢复设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/cross_cluster_replication_settings.html#高级远程恢复设置" class="sidebar-link">高级远程恢复设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/discovery_and_cluster_formation_settings.html" class="sidebar-link">发现和集群组成设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/discovery_and_cluster_formation_settings.html#专家设置" class="sidebar-link">专家设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/field_data_cache_settings.html" class="sidebar-link">字段数据缓存设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/field_data_cache_settings.html#缓存大小" class="sidebar-link">缓存大小</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/field_data_cache_settings.html#监控字段数据" class="sidebar-link">监控字段数据</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/health_diagnostic_settings_in_elasticsearch.html" class="sidebar-link">Elasticsearch 中的健康诊断设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/health_diagnostic_settings_in_elasticsearch.html#集群级设置" class="sidebar-link">集群级设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/index_lifecycle_management_settings.html" class="sidebar-link">Elasticsearch 索引生命周期管理设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/index_lifecycle_management_settings.html#集群级设置" class="sidebar-link">集群级设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/index_lifecycle_management_settings.html#索引级设置" class="sidebar-link">索引级设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/index_management_settings.html" class="sidebar-link">索引管理设置</a></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/index_recovery_settings.html" class="sidebar-link">索引恢复设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/index_recovery_settings.html#恢复设置" class="sidebar-link">恢复设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/index_recovery_settings.html#专家对待恢复设置" class="sidebar-link">专家对待恢复设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/index_recovery_settings.html#托管服务的恢复设置" class="sidebar-link">托管服务的恢复设置</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/indexing_buffer_settings.html" class="sidebar-link">索引缓冲区设置</a></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/license_settings.html" class="sidebar-link">索引缓冲区设置</a></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/local_gateway_settings.html" class="sidebar-link">本地网关设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/local_gateway_settings.html#悬空索引" class="sidebar-link">悬空索引</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html" class="sidebar-link">日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html#日志配置" class="sidebar-link">日志配置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html#配置日志级别" class="sidebar-link">配置日志级别</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html#弃用的日志" class="sidebar-link">弃用的日志</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html#弃用日志限制" class="sidebar-link">弃用日志限制</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/logging.html#json-日志格式" class="sidebar-link">JSON 日志格式</a></li></ul></li><li><a href="/set_up_elasticsearch/configuring_elasticsearch/machine_learning_settings_in_elasticsearch.html" class="sidebar-link">Elasticsearch 中的机器学习设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/machine_learning_settings_in_elasticsearch.html#通用机器学习设置" class="sidebar-link">通用机器学习设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/machine_learning_settings_in_elasticsearch.html#高级机器学习设置" class="sidebar-link">高级机器学习设置</a></li><li class="sidebar-sub-header"><a href="/set_up_elasticsearch/configuring_elasticsearch/machine_learning_settings_in_elasticsearch.html#机器学习断路器设置" class="sidebar-link">机器学习断路器设置</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/index_modules" class="sidebar-heading clickable"><span>索引模块</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rest_apis" class="sidebar-heading clickable"><span>REST API</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="重要的-elasticsearch-配置"><a href="#重要的-elasticsearch-配置" class="header-anchor">#</a> 重要的 Elasticsearch 配置</h1> <p>Elasticsearch 只需要很少的配置即可开始，但在生产中使用集群之前，必须考虑以下几点：</p> <ul><li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E8%B7%AF%E5%BE%84%E8%AE%BE%E7%BD%AE">路径设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E9%9B%86%E7%BE%A4%E5%90%8D%E8%AE%BE%E7%BD%AE">集群名设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E8%8A%82%E7%82%B9%E5%90%8D%E8%AE%BE%E7%BD%AE%5D">节点名设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E7%BD%91%E7%BB%9C%E4%B8%BB%E6%9C%BA%E8%AE%BE%E7%BD%AE">网络主机设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E5%8F%91%E7%8E%B0%E5%92%8C%E9%9B%86%E7%BE%A4%E6%9E%84%E6%88%90%E8%AE%BE%E7%BD%AE">发现设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E5%A0%86%E5%A4%A7%E5%B0%8F%E8%AE%BE%E7%BD%AE">堆大小设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#JVM-%E5%A0%86%E8%BD%AC%E5%82%A8%E8%B7%AF%E5%BE%84%E8%AE%BE%E7%BD%AE">JVM 堆转储路径设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#GC-%E6%97%A5%E5%BF%97%E8%AE%BE%E7%BD%AE">GC 日志设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E4%B8%B4%E6%97%B6%E7%9B%AE%E5%BD%95%E8%AE%BE%E7%BD%AE">临时目录设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#JVM-%E8%87%B4%E5%91%BD%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E8%AE%BE%E7%BD%AE">JVM 致命错误日志设置</a></p></li> <li><p><a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E9%9B%86%E7%BE%A4%E5%A4%87%E4%BB%BD">集群备份</a></p></li></ul> <p>我们的<a href="https://www.elastic.co/cn/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" target="_blank" rel="noopener noreferrer">Elastic Cloud<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>服务自动配置这些项目，默认情况下，使你的集群生产就绪。</p> <h2 id="路径设置"><a href="#路径设置" class="header-anchor">#</a> 路径设置</h2> <p>Elasticsearch 将索引的数据写入索引，并将数据流写入数据目录。Elasticsearch 将自己的应用程序日志写入日志目录，其中包含有关集群运行状况和操作的信息。</p> <p>对于 <a href="/set_up_elasticsearch/installing_elasticsearch/linux">macOS .tar.gz</a>，<a href="/set_up_elasticsearch/installing_elasticsearch/linux">Linux .tar.gz</a> 和 <a href="/set_up_elasticsearch/installing_elasticsearch/windows">Windows .zip</a> 安装，<code>data</code> 和 <code>logs</code> 默认是 <code>$ES_HOME</code> 的子目录。然而，<code>$ES_HOME</code> 中的文件可能在升级过程中被删除。</p> <p>在生产中，我们强烈建议你设置 <code>elasticsearch.yml</code> 中的 <code>path.data</code> 和 <code>path.logs</code> 在 <code>$ES_HOME</code> 之外的位置。默认情况下，<a href="/set_up_elasticsearch/installing_elasticsearch/docker">Docker</a>、<a href="/set_up_elasticsearch/installing_elasticsearch/debian">Debian</a> 和 <a href="/set_up_elasticsearch/installing_elasticsearch/rpm">RPM</a> 安装将数据和日志写入 <code>$ES_HOME</code> 之外的位置。</p> <p>支持的 <code>path.data</code>和 <code>path.logs</code>。值因平台而异：</p> <ul><li>类 Unix 系统</li></ul> <p>Linux 和 macOS 安装支持 Unix 风格的路径：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>path:
  data: /var/data/elasticsearch
  logs: /var/log/elasticsearch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Windows</li></ul> <p>Windows 安装支持带转义反斜杠的 DOS 路径：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>path:
  data: <span class="token string">&quot;C:<span class="token entity" title="\\">\\</span>Elastic<span class="token entity" title="\\">\\</span>Elasticsearch<span class="token entity" title="\\">\\</span>data&quot;</span>
  logs: <span class="token string">&quot;C:<span class="token entity" title="\\">\\</span>Elastic<span class="token entity" title="\\">\\</span>Elasticsearch<span class="token entity" title="\\">\\</span>logs&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">重要</p> <p>不要修改数据目录中的任何内容或运行可能会干扰其内容的进程。如果 Elasticsearch 以外的其他内容修改了数据目录的内容，则 Elasticsearch 可能会失败，报告损坏或其他数据不一致，或者可能在默默丢失部分数据后正常工作。不要尝试对数据目录进行文件系统备份；不支持还原此类备份的方法。相反，请使用<a href="/snapshot_and_restore/snapshot_and_restore">快照和还原</a>来安全地进行备份。不要在数据目录上运行病毒扫描程序。病毒扫描程序可能会阻止 Elasticsearch 正常工作，并可能会修改数据目录的内容。数据目录不包含可执行文件，因此病毒扫描只会发现误报。</p></div> <h2 id="多数据路径"><a href="#多数据路径" class="header-anchor">#</a> 多数据路径</h2> <div class="custom-block danger"><p class="custom-block-title">重要</p> <p>7.13.0 版本已弃用</p></div> <p>如果需要，可以在 <code>path.data</code> 中指定多个路径。Elasticsearch 跨所有提供的路径存储节点的数据，但将每个分片的数据保持在同一路径上。</p> <p>Elasticsearch 不平衡节点数据路径上的分片。单个路径中的高磁盘使用率可以触发整个节点的<a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings#%E5%9F%BA%E4%BA%8E%E7%A3%81%E7%9B%98%E7%9A%84%E5%88%86%E7%89%87%E5%88%86%E9%85%8D%E8%AE%BE%E7%BD%AE">高磁盘利用率水印</a>。如果触发，Elasticsearch 将不会向节点添加分片，即使节点的其他路径具有可用磁盘空间。如果需要额外的磁盘空间，建议您添加新节点，而不是其他数据路径。</p> <ul><li>类 Unix 系统</li></ul> <p>Linux 和 macOS 安装支持 <code>path.data</code> 中的多个 Unix 样式路径：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>path:
  data:
    - /mnt/elasticsearch_1
    - /mnt/elasticsearch_2
    - /mnt/elasticsearch_3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>Windwos</li></ul> <p>Windows 安装支持 <code>path.data</code> 中的多个 DOS 路径：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>path:
  data:
    - <span class="token string">&quot;C:<span class="token entity" title="\\">\\</span>Elastic<span class="token entity" title="\\">\\</span>Elasticsearch_1&quot;</span>
    - <span class="token string">&quot;E:<span class="token entity" title="\\">\\</span>Elastic<span class="token entity" title="\\">\\</span>Elasticsearch_1&quot;</span>
    - <span class="token string">&quot;F:<span class="token entity" title="\\">\\</span>Elastic<span class="token entity" title="\\">\\</span>Elasticsearch_3&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="从多个数据路径迁移"><a href="#从多个数据路径迁移" class="header-anchor">#</a> 从多个数据路径迁移</h2> <p>支持多数据路径在 7.13 中已被弃用，并将在未来版本中删除。</p> <p>作为多数据路径的替代方案，您可以使用硬件虚拟化层（如 RAID）或软件虚拟化层，如 Linux 上的逻辑卷管理器（LVM）或 Windows 上的存储空间，创建跨越多个磁盘的文件系统。如果希望在一台计算机上使用多个数据路径，则必须为每个数据路径运行一个节点。</p> <p>如果当前在<a href="/set_up_a_cluster_for_high_availability/desining_for_resilicence/desining_for_resilicence">高可用集群</a>中使用多个数据路径，则可以迁移到为每个节点使用单一路径的设置，而无需使用类似于<a href="/set_up_elasticsearch/full_cluster_restart_and_rolling_restart#%E6%BB%9A%E5%8A%A8%E9%87%8D%E5%90%AF">滚动重启</a>的过程进行停机：依次关闭每个节点，并将其替换为一个或多个节点，每个节点都配置为使用单一数据路径。更详细地说，对于当前具有多个数据路径的每个节点，应遵循以下过程。原则上，您可以在滚动升级到 8.0 期间执行此迁移，但我们建议在开始升级之前迁移到单个数据路径设置。</p> <ol><li><p>创建快照以在发生灾难时保护你的数据。</p></li> <li><p>可选地，通过使用<a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings#%E9%9B%86%E7%BE%A4%E7%BA%A7%E5%88%86%E7%89%87%E5%88%86%E9%85%8D%E8%BF%87%E6%BB%A4">分配过滤器</a>将数据从目标节点迁移：</p></li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>PUT _cluster/settings
<span class="token punctuation">{</span>
  <span class="token string">&quot;persistent&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;cluster.routing.allocation.exclude._name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;target-node-name&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>你可以使用 <a href="/rest_apis/cat_apis/cat_allocation">cat 分配 API</a> 跟踪数据迁移的进度。如果一些分片没有迁移，那么<a href="/rest_apis/cluster_apis/cluster_allocation_explain">集群分配解释 API</a> 将帮助你确定原因。</p> <ol start="3"><li><p>按照<a href="/set_up_elasticsearch/full_cluster_restart_and_rolling_restart#%E6%BB%9A%E5%8A%A8%E9%87%8D%E5%90%AF">滚动重启过程</a>中的步骤操作，直到关闭目标节点。</p></li> <li><p>确保集群运行状况为 <code>yellow（黄色）</code>或 <code>green（绿色）</code>，以便有分配给集群中至少一个其他节点的每个分片的副本。</p></li> <li><p>如果适用，请删除前面步骤中应用的分配筛选器。</p></li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>PUT _cluster/settings
<span class="token punctuation">{</span>
  <span class="token string">&quot;persistent&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;cluster.routing.allocation.exclude._name&quot;</span><span class="token builtin class-name">:</span> null
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="6"><li><p>通过删除已停止节点的数据路径的内容，丢弃已停止节点持有的数据。</p></li> <li><p>重新配置存储。例如，使用LVM或存储空间将磁盘合并到单个文件系统中。确保重新配置的存储具有足够的空间来存放数据。</p></li> <li><p>通过调整 <code>elasticsearch.yml</code> 文件中的 <code>path.data</code> 设置重新配置节点。如果需要，安装更多节点，每个节点都有自己的 <code>path.data</code> 设置指向单独数据路径。</p></li> <li><p>启动新节点，并对其执行其余的<a href="/set_up_elasticsearch/full_cluster_restart_and_rolling_restart#%E6%BB%9A%E5%8A%A8%E9%87%8D%E5%90%AF">滚动重启过程</a>过程。</p></li> <li><p>确保集群运行状况为绿色，以便已分配每个分片。</p></li></ol> <p>你也可以向集群添加一些单数据路径节点，使用<a href="/set_up_elasticsearch/configuring_elasticsearch/cluster_level_shard_allocation_and_routing_settings#%E9%9B%86%E7%BE%A4%E7%BA%A7%E5%88%86%E7%89%87%E5%88%86%E9%85%8D%E8%BF%87%E6%BB%A4">分配过滤器</a>将所有数据迁移到这些新节点，然后从集群中删除旧节点。这种方法将使集群的大小临时增加一倍，因此只有在你有能力这样扩展集群的情况下，它才能工作。</p> <p>如果你当前使用多个数据路径，但你的群集不是高度可用的，则可以通过创建快照，再创建具有所需配置的新集群并将快照还原到其中，用以迁移到非弃用配置。</p> <h2 id="集群名设置"><a href="#集群名设置" class="header-anchor">#</a> 集群名设置</h2> <p>节点只能在加入集群后，向集群中其他所有节点共享其 <code>cluster.name</code>。默认名称是 <code>elasticsearch</code>，但你应该将其更改为描述集群用途的适当名称。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cluster.name: logging-prod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>不要在不同的环境中重用相同的集群名称。否则，节点可能加入错误的集群。</p> <h2 id="节点名设置"><a href="#节点名设置" class="header-anchor">#</a> 节点名设置</h2> <p>Elasticsearch 使用 <code>node.name</code> 作为 Elasticsearch 特定实例的可读标识符。此名称包含在许多 API 的响应中。节点名称默认为 Elasticsearch 启动时机器的主机名，但可以在 <code>elasticsearch.yml</code> 中显式配置：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>node.name: prod-data-2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="网络主机设置"><a href="#网络主机设置" class="header-anchor">#</a> 网络主机设置</h2> <p>默认情况下，Elasticsearch 仅绑定到回环地址，如 <code>127.0.0.1</code> 和 <code>[：：1]</code>。这足以在单个服务器上运行一个或多个节点的集群进行开发和测试，但<a href="/set_up_a_cluster_for_high_availability/desining_for_resilicence/desining_for_resilicence">弹性生产集群</a>必须涉及其他服务器上的节点。有许多<a href="/set_up_elasticsearch/configuring_elasticsearch/networking">网络设置</a>，但通常只需要配置 <code>network.host</code>：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>network.host: <span class="token number">192.168</span>.1.10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">重要</p> <p>当你提供 <code>network.host</code> 值，Elasticsearch 假设你正在从开发模式转移到生产模式，并将大量系统启动检查从警告升级为异常。查看<a href="set_up_elasticsearch/import_system_configuration/import_system_configuration">开发和生产模式</a>之间的差异。</p></div> <h2 id="发现和集群构成设置"><a href="#发现和集群构成设置" class="header-anchor">#</a> 发现和集群构成设置</h2> <p>在投入生产之前，配置两个重要的发现和群集形成设置，以便群集中的节点可以相互发现并选择主节点。</p> <p><code>discovery.seed_hosts</code></p> <p>开箱即用，无需任何网络配置，Elasticsearch 将绑定到可用的环回地址，并扫描本地端口 <code>9300</code> 至 <code>9305</code>，以与运行在同一服务器上的其他节点连接。这种行为提供了一种无需进行任何配置的自动集群体验。</p> <p>当你希望与其他主机上的节点组成集群时，请使用<a href="/set_up_elasticsearch/configuring_elasticsearch#%E9%9D%99%E6%80%81">静态</a> <code>discovery.seed_hosts</code> 设置。此设置提供群集中其他节点的列表，这些节点具有主资格，并且可能处于活动状态，并且可以联系以启动<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-discovery-hosts-providers.html" target="_blank" rel="noopener noreferrer">发现过程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。此设置接受集群中所有主合格节点的 YAML 序列或地址数组。每个地址可以是 IP 地址，也可以是通过 DNS 解析为一个或多个 IP 地址的主机名。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>discovery.seed_hosts:
   - <span class="token number">192.168</span>.1.10:9300
   - <span class="token number">192.168</span>.1.11 
   - seeds.mydomain.com 
   - <span class="token punctuation">[</span><span class="token number">0</span>:0:0:0:0:ffff:c0a8:10c<span class="token punctuation">]</span>:9301 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li><p><code>192.168.1.11</code>：端口可选，默认为 <code>9300</code>，但可以被<a href="/set_up_elasticsearch/discovery_and_cluster_formation/discovery">覆盖</a>。</p></li> <li><p><code>seeds.mydomain.com</code>：如果主机名解析为多个 IP 地址，则节点将尝试在所有解析的地址发现其他节点。</p></li> <li><p><code>[0:0:0:0:0:ffff:c0a8:10c]:9301</code>：IPv6 地址必须用方括号括起来。</p></li></ol> <p>如果符合主节点条件的节点没有固定名称或地址，请使用备用主机提供程序动态查找其地址。</p> <ul><li><code>cluster.initial_master_nodes</code></li></ul> <p>首次启动 Elasticsearch 集群时，群集引导步骤将确定在第一次选举中计算其投票的主合格节点集。在开发模式下，如果未配置发现设置，此步骤将由节点自己自动执行。</p> <p>由于自动引导<a href="/set_up_elasticsearch/discovery_and_cluster_formation/quorum_based_decision_making">原生不安全</a>，因此在生产模式下启动新集群时，必须明确列出在第一次选举中应计算其投票的主合格节点。你可以使用 <code>cluster.initial_master_nodes</code> 设置此列表。</p> <div class="custom-block danger"><p class="custom-block-title">重要</p> <p>集群首次成功形成后，删除每个节点配置中的 <code>cluster.initial_master_nodes</code> 设置。重新启动集群或向现有集群添加新节点时，不要使用此设置。</p></div> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>discovery.seed_hosts:
   - <span class="token number">192.168</span>.1.10:9300
   - <span class="token number">192.168</span>.1.11
   - seeds.mydomain.com
   - <span class="token punctuation">[</span><span class="token number">0</span>:0:0:0:0:ffff:c0a8:10c<span class="token punctuation">]</span>:9301
cluster.initial_master_nodes: 
   - master-node-a
   - master-node-b
   - master-node-c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol><li><code>cluster.initial_master_nodes</code>：按他们的 <a href="/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E8%8A%82%E7%82%B9%E5%90%8D%E8%AE%BE%E7%BD%AE"><code>node.name</code></a> 标识初始主节点，默认为其主机名。确保 <code>cluster.initial_master_nodes</code> 中的值与 <code>node.name</code> 完全匹配。如果使用完全限定域名（FQDN），例如 <code>master-node-a.example.com</code> 作为节点名称，则必须使用此列表中的 FQDN。相反，如果 <code>node.name</code> 是一个没有任何尾部限定符的裸主机名，你还必须省略 <code>cluster.initial_master_nodes</code> 中的尾部限定符。</li></ol> <p>参阅<a href="/set_up_elasticsearch/discovery_and_cluster_formation/bootstrapping_a_cluster">引导集群</a>以及<a href="/set_up_elasticsearch/configuring_elasticsearch/discovery_and_cluster_formation_setting">发现和集群构成设置</a>。</p> <h2 id="堆大小设置"><a href="#堆大小设置" class="header-anchor">#</a> 堆大小设置</h2> <p>默认情况下，Elasticsearch 根据节点的<a href="/set_up_elasticsearch/configuring_elasticsearch/node#%E8%8A%82%E7%82%B9%E8%A7%92%E8%89%B2">角色</a>和总内存自动设置 JVM 堆大小。我们建议大多数生产环境使用默认大小。</p> <p>如果需要，可以通过手动<a href="/set_up_elasticsearch/configuring_elasticsearch/advanced_configuration#%E8%AE%BE%E7%BD%AE-JVM-%E5%A0%86%E5%A4%A7%E5%B0%8F">设置 JVM 堆大小</a>来覆盖默认大小。</p> <h2 id="jvm-堆转储路径设置"><a href="#jvm-堆转储路径设置" class="header-anchor">#</a> JVM 堆转储路径设置</h2> <p>默认情况下，Elasticsearch 将 JVM 配置为将内存不足异常的堆转储到默认数据目录。在 RPM 和 Debian 软件包中，数据目录是 <code>/var/lib/elasticsearch</code>。在<a href="/set_up_elasticsearch/installing_elasticsearch/linux">Linux 和 MacOS</a> 及 <a href="/set_up_elasticsearch/installing_elasticsearch/windows">Windows</a> 发行版上，<code>data</code> 目录位于 Elasticsearch 安装的根目录下。</p> <p>如果此路径不适合接收堆转储，请修改 <a href="/set_up_elasticsearch/configuring_elasticsearch/advanced_configuration#%E8%AE%BE%E7%BD%AE-JVM-%E9%80%89%E9%A1%B9">jvm.options</a> 中的 <code>-XX:HeapDumpPath=…</code> 条目：</p> <ul><li><p>如果指定目录，JVM 将根据运行实例的 PID 为堆转储生成文件名。</p></li> <li><p>如果指定固定文件名而不是目录，则当 JVM 需要对内存不足异常执行堆转储时，该文件必须不存在。否则，堆转储将失败。</p></li></ul> <h2 id="gc-日志设置"><a href="#gc-日志设置" class="header-anchor">#</a> GC 日志设置</h2> <p>默认情况下，Elasticsearch 启用垃圾收集（GC）日志。这些是在 <a href="/set_up_elasticsearch/configuring_elasticsearch/advanced_configuration#%E8%AE%BE%E7%BD%AE-JVM-%E9%80%89%E9%A1%B9">jvm.options</a> 中配置的，并输出到与 Elasticsearch 日志相同的默认位置。默认配置每 64 MB 旋转一次日志，最多可消耗 2 GB 的磁盘空间。</p> <p>你可以使用<a href="https://openjdk.java.net/jeps/158" target="_blank" rel="noopener noreferrer">JEP 158：统一 JVM 日志<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中描述的命令行选项重新配置 JVM 日志。除非更改默认 <code>jvm.options</code> 文件中，除了你自己的设置之外，还将应用 Elasticsearch 默认配置。要禁用默认配置，首先通过提供 <code>-Xlog:disable</code> 选项禁用日志记录，然后提供您自己的命令行选项。这将禁用<em>所有</em> JVM 日志记录，因此请确保查看可用选项并启用所需的所有功能。</p> <p>要查看原始 JEP 中未包含的其他选项，参阅<a href="https://docs.oracle.com/en/java/javase/13/docs/specs/man/java.html#enable-logging-with-the-jvm-unified-logging-framework" target="_blank" rel="noopener noreferrer">使用 JVM 统一日志框架启用日志<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h2> <p>使用一些示例选项，通过创建 <code>$ES_HOME/config/jvm.options.d/gc.options</code> 来变更默认 GC 日志输出路径为 <code>/opt/my-app/gc.log</code>：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Turn off all previous logging configuratons</span>
<span class="token parameter variable">-Xlog:disable</span>

<span class="token comment"># Default settings from JEP 158, but with `utctime` instead of `uptime` to match the next line</span>
<span class="token parameter variable">-Xlog:all</span><span class="token operator">=</span>warning:stderr:utctime,level,tags

<span class="token comment"># Enable GC logging to a custom location with a variety of options</span>
-Xlog:gc*,gc+age<span class="token operator">=</span>trace,safepoint:file<span class="token operator">=</span>/opt/my-app/gc.log:utctime,pid,tags:filecount<span class="token operator">=</span><span class="token number">32</span>,filesize<span class="token operator">=</span>64m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>配置 Elasticsearch Docker 容器，将 GC 调试日志发送到标准错误（stderr）。这允许容器编排器处理输出。如果使用 <code>CLI_JAVA_OPTS</code> 环境变量，请指定：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">MY_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xlog:disable -Xlog:all=warning:stderr:utctime,level,tags -Xlog:gc=debug:stderr:utctime&quot;</span>
<span class="token function">docker</span> run <span class="token parameter variable">-e</span> <span class="token assign-left variable">CLI_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$MY_OPTS</span>&quot;</span> <span class="token comment"># etc</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="临时目录设置"><a href="#临时目录设置" class="header-anchor">#</a> 临时目录设置</h2> <p>默认情况下，Elasticsearch 使用启动脚本在系统临时目录下创建的私有临时目录。</p> <p>在某些 Linux 发行版上，如果文件和目录最近未被访问，系统实用程序将从 <code>/tmp</code> 中清除这些文件和目录。如果长时间未使用需要临时目录的功能，则此行为可能导致在Elasticsearch运行时删除专用临时目录。如果随后使用需要此目录的功能，则删除专用临时目录会导致问题。</p> <p>如果使用 <code>.deb</code> 或 <code>.rpm</code> 软件包安装 Elasticsearch 并在 <code>systemd</code> 下运行，Elasticsearch 使用的私有临时目录将被排除在定期清理之外。</p> <p>如果你打算运行 <code>.tar.gz</code> 在 Linux 或 MacOS 上的长期发行版，请考虑为 Elasticsearch 创建一个专用的临时目录，该目录不在将清除旧文件和目录的路径下。该目录应设置权限，以便只有运行 Elasticsearch 的用户才能访问该目录。然后，在启动 Elasticsearch 之前，将 <code>$ES_TMPDIR</code> 环境变量设置为指向该目录。</p> <h2 id="jvm-致命错误日志设置"><a href="#jvm-致命错误日志设置" class="header-anchor">#</a> JVM 致命错误日志设置</h2> <p>默认情况下，Elasticsearch 将 JVM 配置为将致命错误日志写入默认日志目录。在 <a href="/set_up_elasticsearch/installing_elasticsearch/rpm">RPM</a> 和 <a href="/set_up_elasticsearch/installing_elasticsearch/debian">Debian</a> 软件包中，这个目录是 <code>/var/log/elasticsearch</code>。在 <a href="/set_up_elasticsearch/installing_elasticsearch/linux">Linux 和 MacOS</a> 和 <a href="/set_up_elasticsearch/installing_elasticsearch/windows">Windows</a> 发行版上，日志目录位于 Elasticsearch 安装的根目录下。</p> <p>这些是 JVM 遇到致命错误（如分段错误）时生成的日志。如果此路径不适合接收日志，请修改 <a href="/set_up_elasticsearch/configuring_elasticsearch/advanced_configuration#%E8%AE%BE%E7%BD%AE-JVM-%E9%80%89%E9%A1%B9">jvm.options</a> 中的 <code>-XX:ErrorFile=…</code> 条目。</p> <h2 id="集群备份"><a href="#集群备份" class="header-anchor">#</a> 集群备份</h2> <p>在灾难中，<a href="/snapshot_and_restore/snapshot_and_restore">快照</a>可以防止永久数据丢失。<a href="/snapshot_and_restore/create_a_snapshot#%E4%BD%BF%E7%94%A8-SLM-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BF%AB%E7%85%A7">快照生命周期管理</a>是对集群进行定期备份的最简单方法。有关详细信息，参阅<a href="/snapshot_and_restore/create_a_snapshot">创建快照</a>。</p> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p><strong>快照是备份集群的唯一可靠且受支持的方法</strong>。你无法通过复制 Elasticsearch 集群节点的数据目录来备份该集群。不支持从文件系统级备份中恢复任何数据的方法。如果尝试从这样的备份中恢复集群，它可能会失败，并报告损坏或丢失文件或其他数据不一致，或者它似乎成功又悄悄地丢失了一些数据。</p></div> <blockquote><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/important-settings.html" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/set_up_elasticsearch/installing_elasticsearch/brew.html" class="prev">
        使用 Homebrew 在 macOS 上安装 Elasticsearch
      </a></span> <span class="next"><a href="/set_up_elasticsearch/configuring_elasticsearch/secure_settings.html">
        安全设置
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f54b6f9f.js" defer></script><script src="/assets/js/2.c3078b94.js" defer></script><script src="/assets/js/121.3ad921c9.js" defer></script>
  </body>
</html>
