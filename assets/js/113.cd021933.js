(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{391:function(s,a,e){"use strict";e.r(a);var t=e(13),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"配置-elasticsearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-elasticsearch"}},[s._v("#")]),s._v(" 配置 Elasticsearch")]),s._v(" "),a("p",[s._v("Elasticsearch 具有良好的默认值，只需要很少的配置。可以使用"),a("a",{attrs:{href:"/rest_apis/cluster_apis/cluster_update_settings"}},[s._v("集群更新设置 API")]),s._v(" 在运行的集群上更改大多数设置。")]),s._v(" "),a("p",[s._v("配置文件应包含特定于节点的设置（如 "),a("code",[s._v("node.name")]),s._v(" 和路径），或节点加入群集所需的设置，如 "),a("code",[s._v("cluster.name")]),s._v(" 和 "),a("code",[s._v("network.host")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"配置文件位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件位置"}},[s._v("#")]),s._v(" 配置文件位置")]),s._v(" "),a("p",[s._v("Elasticsearch有三个配置文件：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("elasticsearch.yml")]),s._v(" 用于配置 Elasticsearch")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("jvm.options")]),s._v(" 用于配置 Elasticsearch JVM 设置")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("log4j2.properties")]),s._v(" 用于配置 Elasticsearch 日志记录")])])]),s._v(" "),a("p",[s._v("这些文件位于 config 目录中，其默认位置取决于安装是来自存档发行版（"),a("code",[s._v("tar.gz")]),s._v(" 或 "),a("code",[s._v("zip")]),s._v("）还是软件包发行版（Debian 或 RPM 软件包）。")]),s._v(" "),a("p",[s._v("对于压缩分发版，配置目录位置默认为 "),a("code",[s._v("$ES_HOME/config")]),s._v("。可以通过 "),a("code",[s._v("ES_PATH_CONF")]),s._v(" 环境变量更改配置目录的位置，如下所示：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_PATH_CONF")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path/to/my/config ./bin/elasticsearch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者，您可以通过命令行或shell概要文件导出ES_PATH_CONF环境变量。")]),s._v(" "),a("p",[s._v("对于包发行版，配置目录位置默认为 "),a("code",[s._v("/etc/elasticsearch")]),s._v("。还可以通过 "),a("code",[s._v("ES_PATH_CONF")]),s._v(" 环境变量更改配置目录的位置，但请注意，在 shell 中设置此值是不够的。相反，这个变量来源于 "),a("code",[s._v("/etc/default/elasticsearch")]),s._v("（对于 Debian 包）和 "),a("code",[s._v("/etc/sysconfig/elasticsearch")]),s._v("（对于 RPM 包）。您需要相应地编辑其中一个文件中的 "),a("code",[s._v("ES_PATH_CONF=/etc/elasticsearch")]),s._v(" 条目，以更改配置目录位置。")]),s._v(" "),a("h2",{attrs:{id:"配置文件格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件格式"}},[s._v("#")]),s._v(" 配置文件格式")]),s._v(" "),a("p",[s._v("配置格式为 "),a("a",{attrs:{href:"https://yaml.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("YAML"),a("OutboundLink")],1),s._v("。以下是更改数据和日志目录路径的示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("path:\n    data: /var/lib/elasticsearch\n    logs: /var/log/elasticsearch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("还可以按如下方式展平设置：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("path.data: /var/lib/elasticsearch\npath.logs: /var/log/elasticsearch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("在 YAML 中，可以将非标量值格式化为序列：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("discovery.seed_hosts:\n   - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.10:9300\n   - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.11\n   - seeds.mydomain.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("虽然不太常见，但也可以将非标量值格式化为数组：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("discovery.seed_hosts: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.1.10:9300"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.1.11"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"seeds.mydomain.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"环境变量替代"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境变量替代"}},[s._v("#")]),s._v(" 环境变量替代")]),s._v(" "),a("p",[s._v("配置文件中使用 "),a("code",[s._v("${…}")]),s._v(" 符号引用的环境变量将替换为环境变量的值。例如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("node.name:    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")]),s._v("}")]),s._v("\nnetwork.host: "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ES_NETWORK_HOST}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("环境变量的值必须是简单字符串。使用逗号分隔的字符串提供 Elasticsearch 将解析为列表的值。例如，Elasticsearch 将以下字符串拆分为 "),a("code",[s._v("${HOSTNAME}")]),s._v(" 环境变量的值列表：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host1,host2"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"集群和节点设置类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群和节点设置类型"}},[s._v("#")]),s._v(" 集群和节点设置类型")]),s._v(" "),a("p",[s._v("集群和节点设置可以根据配置方式进行分类：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("动态")])])]),s._v(" "),a("p",[s._v("你可以使用"),a("a",{attrs:{href:"/rest_apis/cluster_apis/cluster_update_settings"}},[s._v("集群更新设置 API")]),s._v(" 在正在运行的集群上配置和更新动态设置。你还可以使用 "),a("code",[s._v("elasticsearch.yml")]),s._v(" 在未启动或关闭的节点上本地配置动态设置。")]),s._v(" "),a("p",[s._v("使用集群更新设置 API 进行的更新可以是持久的，适用于跨集群重新启动；也可以是瞬时的，在集群重新启动后重置。你还可以通过使用 API 为瞬态或持久设置分配 "),a("code",[s._v("null")]),s._v(" 来重置它们。")]),s._v(" "),a("p",[s._v("如果你使用多个方法配置同一设置，Elasticsearch 将按以下优先顺序应用设置：")]),s._v(" "),a("ol",[a("li",[s._v("瞬态设置")]),s._v(" "),a("li",[s._v("持续设置")]),s._v(" "),a("li",[a("code",[s._v("elasticsearch.yml")]),s._v(" 设置")]),s._v(" "),a("li",[s._v("默认设置值")])]),s._v(" "),a("p",[s._v("例如，可以应用瞬态设置来覆盖持久设置或 "),a("code",[s._v("elasticsearch.yml")]),s._v(" 设置。但是，更改 "),a("code",[s._v("elasticsearch.yml")]),s._v(" 设置不会覆盖已定义的瞬态或持久设置。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("如果使用 Elasticsearch 服务，请使用"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/cloud/current/ec-add-user-settings.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("用户设置"),a("OutboundLink")],1),s._v("功能配置所有集群设置。此方法允许 Elasticsearch 服务自动拒绝可能破坏集群的不安全设置。"),a("br"),s._v(" 如果你在自己的硬件上运行 Elasticsearch，请使用"),a("a",{attrs:{href:"/rest_apis/cluster_apis/cluster_update_settings"}},[s._v("集群更新设置 API")]),s._v(" 配置动态集群设置。仅使用 "),a("code",[s._v("elasticsearch.yml")]),s._v(" 用于静态集群设置和节点设置。API 不需要重新启动，并确保设置的值在所有节点上都相同。")])]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("我们不再建议使用临时集群设置。请改用永久集群设置。如果集群变得不稳定，瞬态设置可能会意外清除，从而导致可能不需要的集群配置。参阅"),a("a",{attrs:{href:"/migration_guide/8.0/transient_settings_migration_guide"}},[s._v("瞬态设置迁移指南")]),s._v("。")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("静态")])])]),s._v(" "),a("p",[s._v("只能使用 "),a("code",[s._v("elasticsearch.yml")]),s._v(" 在未启动或关闭的节点上配置静态设置。")]),s._v(" "),a("p",[s._v("必须在集群中的每个相关节点上设置静态设置。")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);