(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{382:function(s,a,_){"use strict";_.r(a);var t=_(13),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"滚动-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#滚动-api"}},[s._v("#")]),s._v(" 滚动 API")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("我们不再建议使用滚动 API 进行深度分页。如果在分页超过 10,000 次点击时需要保留索引状态，请在时间点（PIT）使用 "),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E6%90%9C%E5%AF%BB"}},[a("code",[s._v("search_after")])]),s._v(" 参数。")])]),s._v(" "),a("p",[s._v("检索"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E6%BB%9A%E5%8A%A8%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C"}},[s._v("滚动搜索")]),s._v("的下一批结果。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET /_search/scroll\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scroll_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAAD4WYm9laVYtZndUQlNsdDcwakFMNjU1QQ=="')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[s._v("#")]),s._v(" 请求")]),s._v(" "),a("p",[a("code",[s._v("GET /_search/scroll/<scroll_id>")]),s._v(" ["),a("s",[s._v("7.0.0")]),s._v("]")]),s._v(" "),a("p",[a("code",[s._v("GET /_search/scroll")])]),s._v(" "),a("p",[a("code",[s._v("POST /_search/scroll/<scroll_id>")]),s._v(" ["),a("s",[s._v("7.0.0")]),s._v("]")]),s._v(" "),a("p",[a("code",[s._v("POST /_search/scroll")])]),s._v(" "),a("h2",{attrs:{id:"前置条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[s._v("#")]),s._v(" 前置条件")]),s._v(" "),a("ul",[a("li",[s._v("如果 Elasticsearch 安全特性启用，你必须对目标数据流、索引或别名有 "),a("code",[s._v("read")]),s._v(" "),a("a",{attrs:{href:"/secure_the_elastic_statck/user_authorization/security_privileges#%E7%B4%A2%E5%BC%95%E6%9D%83%E9%99%90"}},[s._v("索引权限")]),s._v("。")])]),s._v(" "),a("h2",{attrs:{id:"描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[s._v("#")]),s._v(" 描述")]),s._v(" "),a("p",[s._v("你可以使用滚动 API 从单个滚动搜索请求中检索大量结果。")]),s._v(" "),a("p",[s._v("滚动 API 需要滚动 ID。要获取滚动 ID，请提交包含"),a("a",{attrs:{href:"/rest_apis/search_apis/search"}},[s._v("滚动查询参数")]),s._v("的"),a("a",{attrs:{href:"/rest_apis/search_apis/search"}},[s._v("搜索 API")]),s._v("请求。"),a("code",[s._v("scroll")]),s._v(" 参数指示 Elasticsearch 应为请求保留"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E4%BF%9D%E6%8C%81%E6%90%9C%E7%B4%A2%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AD%98%E6%B4%BB"}},[s._v("搜索上下文")]),s._v("的时间。")]),s._v(" "),a("p",[s._v("搜索响应在响应体参数 "),a("code",[s._v("_scroll_id")]),s._v(" 中返回一个滚动 ID。然后，你可以使用滚动 ID 和滚动 API 来检索请求的下一批结果。如果 Elasticsearch 安全功能已启用，则对特定滚动 ID 的结果的访问仅限于"),a("a",{attrs:{href:"/secure_the_elastic_stack/limitations#%E7%94%A8%E6%88%B7%E5%92%8C-API-%E5%AF%86%E9%92%A5%E7%9A%84%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%E6%A3%80%E6%9F%A5"}},[s._v("提交搜索的用户或 API 密钥")]),s._v("。")]),s._v(" "),a("p",[s._v("你还可以使用scroll API指定新的滚动参数，以延长或缩短搜索上下文的保留期。")]),s._v(" "),a("p",[s._v("参阅"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E6%BB%9A%E5%8A%A8%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C"}},[s._v("滚动搜索结果")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("滚动搜索的结果反映了初始搜索请求时索引的状态。后续的索引或文档更改只会影响以后的搜索和滚动请求。")])]),s._v(" "),a("h2",{attrs:{id:"路径参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路径参数"}},[s._v("#")]),s._v(" 路径参数")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("<scroll_id>")]),s._v("\n["),a("s",[s._v("7.0.0")]),s._v("]（可选，字符串）搜索的滚动 ID。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("滚动 ID 可能很长。我们建议仅使用 "),a("a",{attrs:{href:"/rest_apis/search_apis/scroll"}},[a("code",[s._v("scroll_id")]),s._v(" 请求体参数")]),s._v("指定滚动 ID。")])])])]),s._v(" "),a("h2",{attrs:{id:"查询参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询参数"}},[s._v("#")]),s._v(" 查询参数")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("scroll")])]),s._v(" "),a("p",[s._v("（可选，"),a("a",{attrs:{href:"/rest_apis/api_convention/common_options#%E6%97%B6%E9%97%B4%E5%8D%95%E4%BD%8D"}},[s._v("时间值")]),s._v("）保留用于滚动的"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E4%BF%9D%E6%8C%81%E6%90%9C%E7%B4%A2%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AD%98%E6%B4%BB"}},[s._v("搜索上下文")]),s._v("的期间。参阅"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E6%BB%9A%E5%8A%A8%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C"}},[s._v("滚动搜索结果")]),s._v("。")]),s._v(" "),a("p",[s._v("该值覆盖原始搜索 API 请求的 "),a("code",[s._v("scroll")]),s._v(" 参数设置的持续时间。")]),s._v(" "),a("p",[s._v("默认情况下，此值不能超过 "),a("code",[s._v("1d")]),s._v("（24小时）。你可以通过 "),a("code",[s._v("search.max_keep_alive")]),s._v(" 集群设置修改些限制。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("你还可以通过请求体参数 "),a("code",[s._v("scroll")]),s._v(" 指定该值。如果同时指定了这两个参数，则只使用查询参数。")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("scroll_id")])]),s._v(" "),a("p",[s._v("["),a("s",[s._v("7.0.0")]),s._v("]（可选，字符串）搜索的滚动 ID。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("滚动 ID 可能很长。我们建议仅使用 "),a("a",{attrs:{href:"/rest_apis/search_apis/scroll"}},[a("code",[s._v("scroll_id")]),s._v(" 请求体参数")]),s._v("指定滚动 ID。")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("rest_total_hits_as_int")])]),s._v(" "),a("p",[s._v("(可选，布尔值)如果为 "),a("code",[s._v("true")]),s._v("，API 响应的 "),a("code",[s._v("hits.total")]),s._v(" 属性以整数返回。如果为 "),a("code",[s._v("false")]),s._v("，API 响应的 "),a("code",[s._v("hits.total")]),s._v(" 属性以对象返回。默认为 "),a("code",[s._v("false")]),s._v("。")])])]),s._v(" "),a("h2",{attrs:{id:"请求体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求体"}},[s._v("#")]),s._v(" 请求体")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("scroll")])]),s._v(" "),a("p",[s._v("（可选，"),a("a",{attrs:{href:"/rest_apis/api_convention/common_options#%E6%97%B6%E9%97%B4%E5%8D%95%E4%BD%8D"}},[s._v("时间值")]),s._v("）保留用于滚动的"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E4%BF%9D%E6%8C%81%E6%90%9C%E7%B4%A2%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AD%98%E6%B4%BB"}},[s._v("搜索上下文")]),s._v("的期间。参阅"),a("a",{attrs:{href:"/search_your_data/paginate_search_results#%E6%BB%9A%E5%8A%A8%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C"}},[s._v("滚动搜索结果")]),s._v("。")]),s._v(" "),a("p",[s._v("该值覆盖原始搜索 API 请求的 "),a("code",[s._v("scroll")]),s._v(" 参数设置的持续时间。")]),s._v(" "),a("p",[s._v("默认情况下，此值不能超过 "),a("code",[s._v("1d")]),s._v("（24小时）。你可以通过 "),a("code",[s._v("search.max_keep_alive")]),s._v(" 集群设置修改些限制。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("你还可以通过查询参数 "),a("code",[s._v("scroll")]),s._v(" 指定该值。如果同时指定了这两个参数，则只使用查询参数。")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("scroll_id")])]),s._v(" "),a("p",[s._v("（必需，字符串）搜索的滚动 ID。")])])]),s._v(" "),a("h2",{attrs:{id:"响应体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应体"}},[s._v("#")]),s._v(" 响应体")]),s._v(" "),a("p",[s._v("滚动 API 返回与搜索 API 相同的响应体。参阅搜索 API 的"),a("a",{attrs:{href:"/rest_apis/search_apis/search#%E5%93%8D%E5%BA%94%E4%BD%93"}},[s._v("响应体参数")]),s._v("。")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/scroll-api.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);