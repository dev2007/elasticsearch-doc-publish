(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{355:function(e,_,s){"use strict";s.r(_);var v=s(13),a=Object(v.a)({},(function(){var e=this,_=e._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"索引统计-api"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#索引统计-api"}},[e._v("#")]),e._v(" 索引统计 API")]),e._v(" "),_("p",[e._v("返回一个或多个索引的统计。对于数据流，API 返回数据流的备份索引的的统计。")]),e._v(" "),_("div",{staticClass:"language-bash line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("GET /my-index-000001/_stats\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("h2",{attrs:{id:"请求"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[e._v("#")]),e._v(" 请求")]),e._v(" "),_("p",[_("code",[e._v("GET /<target>/_stats/<index-metric>")])]),e._v(" "),_("p",[_("code",[e._v("GET /<target>/_stats")])]),e._v(" "),_("p",[_("code",[e._v("GET /_stats")])]),e._v(" "),_("h2",{attrs:{id:"前置条件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[e._v("#")]),e._v(" 前置条件")]),e._v(" "),_("ul",[_("li",[e._v("如果 Elasticsearch 安全特性启用，你使用此 API 必须有 "),_("code",[e._v("monitor")]),e._v(" 或 "),_("code",[e._v("manage")]),e._v(" "),_("a",{attrs:{href:"/secure_the_elastic_statck/user_authorization/security_privileges#%E7%B4%A2%E5%BC%95%E6%9D%83%E9%99%90"}},[e._v("索引权限")]),e._v("。")])]),e._v(" "),_("h2",{attrs:{id:"描述"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[e._v("#")]),e._v(" 描述")]),e._v(" "),_("p",[e._v("使用索引统计 API 获取一个或多个数据流和索引的高级聚合和统计信息。")]),e._v(" "),_("p",[e._v("默认情况下，返回的统计信息是索引级别的，包含 "),_("code",[e._v("primaries")]),e._v(" 和 "),_("code",[e._v("total")]),e._v(" 聚合。"),_("code",[e._v("primaries")]),e._v(" 是仅主分片的值。"),_("code",[e._v("total")]),e._v(" 是主分片和副本分片的累积值。")]),e._v(" "),_("p",[e._v("要获取分片级别统计信息，请将 "),_("code",[e._v("level")]),e._v(" 参数设置为 "),_("code",[e._v("shards")]),e._v("。")]),e._v(" "),_("blockquote",[_("p",[e._v("移动到另一个节点时，将清除分片的碎片级别统计信息。尽管分片不再是节点的一部分，但该节点保留分片所贡献的任何节点级统计信息。")])]),e._v(" "),_("h2",{attrs:{id:"路径参数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#路径参数"}},[e._v("#")]),e._v(" 路径参数")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("<target>")])]),e._v(" "),_("p",[e._v("（可选，字符串）限制请求的逗号分隔的数据流、索引和别名的列表。支持通配符（*）。要以所有数据流和索引为目标，忽略此参数或使用 "),_("code",[e._v("*")]),e._v(" 或 "),_("code",[e._v("_all")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("<index-metric>")])]),e._v(" "),_("p",[e._v("（可选，字符串）用于限制请求的，逗号分隔的指标。支持的指标有：")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("_all")]),e._v("\n返回所有统计")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("completion")]),e._v(" "),_("a",{attrs:{href:"/search_apis/suggesters#%E5%AE%8C%E6%88%90%E5%BB%BA%E8%AE%AE%E5%99%A8"}},[e._v("完成建议")]),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("docs")]),e._v("\n尚未合并的文档数和已删除的文档数。"),_("a",{attrs:{href:"rest_apis/index_apis/refresh"}},[e._v("索引刷新")]),e._v("会影响统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("fielddata")]),e._v(" "),_("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/fielddata.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("字段数据"),_("OutboundLink")],1),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("flush")]),e._v(" "),_("a",{attrs:{href:"/rest_apis/index_apis/flush"}},[e._v("Flush")]),e._v(" 统计")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("get")]),e._v("\n获取统计，包括丢失的统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("indexing")]),e._v(" "),_("a",{attrs:{href:"/rest_apis/document_apis/esindex"}},[e._v("索引")]),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("merge")]),e._v(" "),_("a",{attrs:{href:"/index_modules/merge"}},[e._v("合并")]),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("query_cache")]),e._v(" "),_("RouterLink",{attrs:{to:"/set_up_elasticsearch/configuring_elasticsearch/node_query_cache_settings.html"}},[e._v("查询缓存")]),e._v("统计。")],1)]),e._v(" "),_("li",[_("p",[_("code",[e._v("refresh")]),e._v(" "),_("RouterLink",{attrs:{to:"/rest_apis/index_apis/refresh.html"}},[e._v("刷新")]),e._v("统计。")],1)]),e._v(" "),_("li",[_("p",[_("code",[e._v("request_cache")]),e._v(" "),_("RouterLink",{attrs:{to:"/set_up_elasticsearch/configuring_elasticsearch/shard_request_cache_setttings.html"}},[e._v("分片请求缓存")]),e._v("统计。")],1)]),e._v(" "),_("li",[_("p",[_("code",[e._v("search")]),e._v("\n搜索统计信息，包括建议统计信息。您可以通过添加额外的 "),_("code",[e._v("groups")]),e._v(" 参数（搜索操作可以与一个或多个组关联）来包括自定义组的统计信息。"),_("code",[e._v("groups")]),e._v(" 参数接受以逗号分隔的组名列表。使用 "),_("code",[e._v("_all")]),e._v(" 返回所有组的统计信息。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("segments")]),e._v("\n所有开放段的内存使用。")]),e._v(" "),_("p",[e._v("如果 "),_("code",[e._v("include_segment_file_size")]),e._v(" 参数为 "),_("code",[e._v("true")]),e._v("，则此度量包括每个 Lucene 索引文件的聚合磁盘使用率。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("store")]),e._v(" "),_("a",{attrs:{href:"/rest_apis/api_convention/common_options#%E5%AD%97%E8%8A%82%E5%A4%A7%E5%B0%8F%E5%8D%95%E4%BD%8D"}},[e._v("字节单位")]),e._v("的索引大小。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("suggest")]),e._v(" "),_("a",{attrs:{href:"/rest_apis/search_apis/suggesters"}},[e._v("建议器")]),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("translog")]),e._v(" "),_("a",{attrs:{href:"/index_modules/translog"}},[e._v("事务日志")]),e._v("统计。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("warmer")]),e._v(" "),_("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-warmers.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("warmer"),_("OutboundLink")],1),e._v(" 统计。")])])])])]),e._v(" "),_("h2",{attrs:{id:"查询参数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#查询参数"}},[e._v("#")]),e._v(" 查询参数")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("expand_wildcards")])]),e._v(" "),_("p",[e._v("（可选，字符串）通配符表达式可以匹配的索引类型。如果请求可以数据流为目标，则此参数确定通配符表达式是否匹配隐藏的数据流。支持逗号分隔的值，如 "),_("code",[e._v("open,hidden")]),e._v("。有效的值有：")]),e._v(" "),_("ol",[_("li",[_("code",[e._v("all")]),e._v("\n匹配任何数据流或索引，包括 "),_("a",{attrs:{href:"/rest_apis/api_convention/multi_target_syntax#%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E6%B5%81%E5%92%8C%E7%B4%A2%E5%BC%95"}},[e._v("hidden")]),e._v("（隐藏的）。")]),e._v(" "),_("li",[_("code",[e._v("open")]),e._v("\n匹配 open（开启）、非隐藏的索引。也匹配任何非隐藏的数据流。")]),e._v(" "),_("li",[_("code",[e._v("closed")]),e._v("\n匹配 closed（关闭）、非隐藏的索引。也匹配任何非隐藏的数据流。数据流不能关闭。")]),e._v(" "),_("li",[_("code",[e._v("hidden")]),e._v("\n匹配隐藏数据流和隐藏索引。必须与 "),_("code",[e._v("open")]),e._v("、"),_("code",[e._v("closed")]),e._v(" 或一起使用。")]),e._v(" "),_("li",[_("code",[e._v("none")]),e._v("\n不接受通配符表达式。")])]),e._v(" "),_("p",[e._v("默认为 "),_("code",[e._v("open")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("fields")])]),e._v(" "),_("p",[e._v("（可选，字符串）逗号分隔的包含在统计中的字段列表或通配符表达式。")]),e._v(" "),_("p",[e._v("除非在 "),_("code",[e._v("completion_fields")]),e._v(" 或 "),_("code",[e._v("fielddata_fields")]),e._v(" 参数中提供了特定字段列表，否则用作默认列表。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("completion_fields")])]),e._v(" "),_("p",[e._v("（可选，字符串）逗号分隔的包含在 "),_("code",[e._v("fielddata")]),e._v(" 和 "),_("code",[e._v("suggest")]),e._v(" 统计中的字段列表或通配符表达式。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("fielddata_fields")])]),e._v(" "),_("p",[e._v("（可选，字符串）逗号分隔的包含在 "),_("code",[e._v("fielddata")]),e._v(" 统计中的字段列表或通配符表达式。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("forbid_closed_indices")])]),e._v(" "),_("p",[e._v("（可选，布尔值）如果为 "),_("code",[e._v("true")]),e._v("，不会从关闭索引统计。默认为 "),_("code",[e._v("true")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("groups")])]),e._v(" "),_("p",[e._v("（可选，字符串）逗号分隔的包含在 "),_("code",[e._v("search")]),e._v(" 统计中的字段列表或通配符表达式。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("level")])]),e._v(" "),_("p",[e._v("（可选，字符串）表明是在群集、索引还是分片级别聚合统计信息。")]),e._v(" "),_("p",[e._v("有效值有：")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("cluster")])])]),e._v(" "),_("li",[_("p",[_("code",[e._v("indices")])])]),e._v(" "),_("li",[_("p",[_("code",[e._v("shards")])])])])]),e._v(" "),_("li",[_("p",[_("code",[e._v("include_segment_file_sizes")])]),e._v(" "),_("p",[e._v("（可选，布尔值）如果为 "),_("code",[e._v("true")]),e._v("，该调用报告每个 Lucene 索引文件的聚合磁盘使用情况（仅在请求段统计信息时适用）。默认为 "),_("code",[e._v("false")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("include_unloaded_segments")])]),e._v(" "),_("p",[e._v("（可选，布尔值）如果为 "),_("code",[e._v("true")]),e._v("，响应包括来自未加载到内存中的段的信息。默认为 "),_("code",[e._v("false")]),e._v("。")])])]),e._v(" "),_("h2",{attrs:{id:"示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[e._v("#")]),e._v(" 示例")]),e._v(" "),_("h3",{attrs:{id:"获取多个数据流的统计信息并指示"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#获取多个数据流的统计信息并指示"}},[e._v("#")]),e._v(" 获取多个数据流的统计信息并指示")]),e._v(" "),_("div",{staticClass:"language-bash line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("GET /index1,index2/_stats\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("h3",{attrs:{id:"获取群集中所有数据流和索引的统计信息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#获取群集中所有数据流和索引的统计信息"}},[e._v("#")]),e._v(" 获取群集中所有数据流和索引的统计信息")]),e._v(" "),_("div",{staticClass:"language-bash line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("GET /_stats\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("h3",{attrs:{id:"获取指定的统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#获取指定的统计"}},[e._v("#")]),e._v(" 获取指定的统计")]),e._v(" "),_("p",[e._v("以下请求仅返回所有索引的 "),_("code",[e._v("merge")]),e._v(" 和 "),_("code",[e._v("refresh")]),e._v(" 统计信息。")]),e._v(" "),_("div",{staticClass:"language-bash line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("GET /_stats/merge,refresh\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("h3",{attrs:{id:"获取特定搜索组的统计信息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#获取特定搜索组的统计信息"}},[e._v("#")]),e._v(" 获取特定搜索组的统计信息")]),e._v(" "),_("p",[e._v("以下请求仅返回 "),_("code",[e._v("group1")]),e._v(" 和 "),_("code",[e._v("group2")]),e._v(" 搜索组的搜索统计信息。")]),e._v(" "),_("div",{staticClass:"language-bash line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("GET /_stats/search?groups"),_("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("group1,group2\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("blockquote",[_("p",[_("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-stats.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("原文链接"),_("OutboundLink")],1)])])])}),[],!1,null,null,null);_.default=a.exports}}]);