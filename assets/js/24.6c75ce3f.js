(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{304:function(t,e,_){"use strict";_.r(e);var a=_(13),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"每节点分片总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#每节点分片总数"}},[t._v("#")]),t._v(" 每节点分片总数")]),t._v(" "),e("p",[t._v("集群级分片分配器尝试将单个索引的分片分布在尽可能多的节点上。然而，根据你有多少分片和索引，以及它们有多大，可能并不总是能够均匀地分布分片。")]),t._v(" "),e("p",[t._v("以下的 "),e("code",[t._v("dynamic")]),t._v("（动态）设置允许你对每个节点允许的单索引的分片总数，指定硬限制：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("index.routing.allocation.total_shards_per_node")])])]),t._v(" "),e("p",[t._v("将分配给单节点的分片（副本和主分片）最大数量。默认为无界。")]),t._v(" "),e("p",[t._v("你也可以限制节点可以拥有的分片数量，而不用考虑索引：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("cluster.routing.allocation.total_shards_per_node")])])]),t._v(" "),e("p",[t._v("（"),e("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch#%E9%9B%86%E7%BE%A4%E5%92%8C%E8%8A%82%E7%82%B9%E8%AE%BE%E7%BD%AE%E7%B1%BB%E5%9E%8B"}},[t._v("动态")]),t._v("）分配给每个节点的主分片和副本分片的最大数量。默认值为 "),e("code",[t._v("-1")]),t._v("（无限制）。")]),t._v(" "),e("p",[t._v("Elasticsearch 在分片分配期间检查此设置。例如，一个集群的 "),e("code",[t._v("cluster.routing.allocation.total_shards_per_node")]),t._v(" 设置为 "),e("code",[t._v("100")]),t._v("，三个节点具有以下分片分配：")]),t._v(" "),e("ul",[e("li",[t._v("节点 A: 100 分片")]),t._v(" "),e("li",[t._v("节点 B: 98 分片")]),t._v(" "),e("li",[t._v("节点 C: 1 分片")])]),t._v(" "),e("p",[t._v("如果节点 C 失败，Elasticsearch 重分配它的分片到节点 B。重分配分片到节点 A 会超出 A 的分片限制。")]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),e("p",[t._v("这些设置强加了一个硬限制，这可能导致一些分片不被分配。"),e("br"),t._v("\n小心使用。")])]),t._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/allocation-total-shards.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文链接"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);