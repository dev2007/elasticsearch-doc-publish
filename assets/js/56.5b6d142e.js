(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{399:function(s,a,t){"use strict";t.r(a);var n=t(13),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"创建或更新索引模板-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建或更新索引模板-api"}},[s._v("#")]),s._v(" 创建或更新索引模板 API")]),s._v(" "),a("p",[s._v("创建或更新一个索引模板。索引模板定义了可以自动用于新索引的"),a("a",{attrs:{href:"/index_modules#%E7%B4%A2%E5%BC%95%E8%AE%BE%E7%BD%AE"}},[s._v("设置")]),s._v("、"),a("a",{attrs:{href:"/mapping/mapping"}},[s._v("映射")]),s._v("和"),a("a",{attrs:{href:"/rest_apis/index_apis/aliases"}},[s._v("别名")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"te*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"priority"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[s._v("#")]),s._v(" 请求")]),s._v(" "),a("p",[a("code",[s._v("PUT /_index_template/<index-template>")])]),s._v(" "),a("h2",{attrs:{id:"前置条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[s._v("#")]),s._v(" 前置条件")]),s._v(" "),a("ul",[a("li",[s._v("如果 Elasticsearch 安全特性启用，你使用此 API 必须有 "),a("code",[s._v("manage_index_templates")]),s._v(" 或 "),a("code",[s._v("manage")]),s._v(" "),a("a",{attrs:{href:"/secure_the_elastic_statck/user_authorization/security_privileges#%E9%9B%86%E7%BE%A4%E6%9D%83%E9%99%90"}},[s._v("集群权限")]),s._v("。")])]),s._v(" "),a("h2",{attrs:{id:"描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[s._v("#")]),s._v(" 描述")]),s._v(" "),a("p",[s._v("Elasticsearch 基于通配符模式来匹配索引名字，将模板应用于相应的新索引。")]),s._v(" "),a("p",[s._v("索引模板通过数据流或索引创建时应用。对数据流而言，当数据流的备份索引创建时，这些设置和映射会被应用。在[创建索引]((/rest_apis/index_apis/create_index)请求中指定的设置和映射会重载索引模板中指定的任意设置或映射。")]),s._v(" "),a("p",[s._v("修改索引模板不会影响已有的索引，包括数据流已有的备份索引。")]),s._v(" "),a("h3",{attrs:{id:"索引模板中的注释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引模板中的注释"}},[s._v("#")]),s._v(" 索引模板中的注释")]),s._v(" "),a("p",[s._v("你可以在索引模板中使用 C 风格的 /* */ 块注释。除了在大括号之前，你可以在请求体任何地方包含注释。")]),s._v(" "),a("h2",{attrs:{id:"路径参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路径参数"}},[s._v("#")]),s._v(" 路径参数")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("<index-template>")])])]),s._v(" "),a("p",[s._v("（必需，字符串）待创建索引模板名字。")]),s._v(" "),a("h2",{attrs:{id:"查询参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询参数"}},[s._v("#")]),s._v(" 查询参数")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("create")])])]),s._v(" "),a("p",[s._v("（可选，布尔值）如果为 "),a("code",[s._v("true")]),s._v("，此请求不会替代或更新已有的索引模板。默认为 "),a("code",[s._v("false")]),s._v("。")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("master_timeout")])])]),s._v(" "),a("p",[s._v("（可选，"),a("a",{attrs:{href:"/rest_apis/api_convention/common_options#%E6%97%B6%E9%97%B4%E5%8D%95%E4%BD%8D"}},[s._v("时间单位")]),s._v("）等待连接到主节点的时间。如果在超时过期前没有收到响应，则请求失败并返回错误。默认为 "),a("code",[s._v("30s")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"请求体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求体"}},[s._v("#")]),s._v(" 请求体")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("composed_of")])])]),s._v(" "),a("p",[s._v("（可选，字符串数组）一个组件模板名称的有序列表。组件模板按指定的顺序合并，这意味着最后指定的组件模板具有最高的优先级。参阅"),a("a",{attrs:{href:"/rest_apis/index_apis/create_or_update_index_template#%E7%BB%84%E5%90%88%E5%88%AB%E5%90%8D%E3%80%81%E6%98%A0%E5%B0%84%E5%92%8C%E8%AE%BE%E7%BD%AE"}},[s._v("组合多个组件模板")]),s._v("查看示例。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("data_stream")])]),s._v(" "),a("p",[s._v("（可选，对象）如果这个对象被包含了，那么这个模板将会用于创建数据流和他们的备份索引。支持一个空对象。")]),s._v(" "),a("p",[s._v("数据流必须有 "),a("code",[s._v("data_stream")]),s._v(" 对象来匹配索引模板。参阅"),a("a",{attrs:{href:"/data_streams/set_up_a_data_stream/set_up_a_data_stream#%E7%AC%AC-3-%E6%AD%A5.%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E6%A8%A1%E6%9D%BF"}},[s._v("创建索引模板")]),s._v("。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("data_stream")]),s._v(" 属性")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("hidden")])])]),s._v(" "),a("p",[s._v("（可选，字符串）如果为 "),a("code",[s._v("true")]),s._v("，数据流是"),a("a",{attrs:{href:"/rest_apis/api_conventions/multi-target_syntax#%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E6%B5%81%E5%92%8C%E7%B4%A2%E5%BC%95"}},[s._v("隐藏的")]),s._v("。默认为 "),a("code",[s._v("false")]),s._v("。")])])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("index_patterns")])]),s._v(" "),a("p",[s._v("（必需的，字符串数组）用于在创建时匹配数据流和索引名字的通配符（*）表达式数组。")]),s._v(" "),a("p",[s._v("Elasticsearch 包含几个内置的索引模板。为了避免这些模板的命名冲突，参阅"),a("a",{attrs:{href:"/index_templates/index_templates"}},[s._v("避免索引模式冲突")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("_meta")])]),s._v(" "),a("p",[s._v("（可选，对象）关于索引模板的可选用户元数据。可以有任意内容。Elasticsearch 不会自动生成此信息。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("priority")])]),s._v(" "),a("p",[s._v("（可选，整数）用于在创建新数据流或索引时确定索引模板的优先级。具有最高优先级的索引模板先被选择。如果未指定优先级，则将模板视为优先级为 0（最低优先级）。Elasticsearch 不会自动生成此值。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("template")])]),s._v(" "),a("p",[s._v("（可选，对象）要应用的模板。它可以选择包括别名、映射或设置配置。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("template")]),s._v(" 属性")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("aliases")])]),s._v(" "),a("p",[s._v("（可选，对象）索引的别名。如果索引模板包含了 "),a("code",[s._v("data_stream")]),s._v("，此参数不被支持。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("aliases")]),s._v(" 对象属性")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("<alias>")])])]),s._v(" "),a("p",[s._v("（必需，对象）键值是别名名称。支持"),a("a",{attrs:{href:"/rest_apis/api_convention/date_math_support_in_index_names"}},[s._v("日期数学")]),s._v("。")]),s._v(" "),a("p",[s._v("对象体包含别名的选项。支持空对象。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("<alias>")]),s._v(" 属性")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("filter")])]),s._v(" "),a("p",[s._v("（可选，查询 DSL 对象）用于限制别名查询时可以访问的文档。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("index_routing")])]),s._v(" "),a("p",[s._v("（可选，字符串）用于将索引操作路由到特定分片的值。如果指定，这将覆盖索引操作的路由值。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("is_hidden")])]),s._v(" "),a("p",[s._v("（可选，布尔值）如果为 "),a("code",[s._v("true")]),s._v("，别名是"),a("a",{attrs:{href:"/rest_apis/api_conventions/multi-target_syntax#%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E6%B5%81%E5%92%8C%E7%B4%A2%E5%BC%95"}},[s._v("隐藏的")]),s._v("。默认为 "),a("code",[s._v("false")]),s._v("。别名所有的索引必须有相同的 "),a("code",[s._v("is_hidden")]),s._v(" 值。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("is_write_index")])]),s._v(" "),a("p",[s._v("（可选，布尔值）如果为 "),a("code",[s._v("true")]),s._v("，索引是别名的"),a("a",{attrs:{href:"/rest_apis/index_apis/aliases#%E5%86%99%E7%B4%A2%E5%BC%95"}},[s._v("写索引")]),s._v("。默认为 "),a("code",[s._v("false")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("routing")])]),s._v(" "),a("p",[s._v("（可选，字符串）用于将索引和搜索操作路由到特定分片的值。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("search_routing")])]),s._v(" "),a("p",[s._v("（可选，字符串）用于将搜索操作路由到特定分片的值。如果指定，这将覆盖搜索操作的 "),a("code",[s._v("routing")]),s._v(" 值。")])])])])])])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("mappings")])]),s._v(" "),a("p",[s._v("（可选，"),a("a",{attrs:{href:"/mapping/mapping"}},[s._v("映射对象")]),s._v("）索引中字段的映射。如果指定，此映射可以包括：")]),s._v(" "),a("ul",[a("li",[s._v("字段名字")]),s._v(" "),a("li",[a("a",{attrs:{href:"/mapping/filed_data_types/filed_data_types"}},[s._v("字段数据类型")])]),s._v(" "),a("li",[a("a",{attrs:{href:"/mapping/mapping_parameters/mapping_parameters"}},[s._v("映射参数")])])]),s._v(" "),a("p",[s._v("参阅"),a("a",{attrs:{href:"/mapping/mapping"}},[s._v("映射")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("settings")]),s._v("\n（可选，"),a("a",{attrs:{href:"/index_modules#%E7%B4%A2%E5%BC%95%E8%AE%BE%E7%BD%AE"}},[s._v("索引设置对象")]),s._v("）索引的配置索引。参阅"),a("a",{attrs:{href:"/index_modules#%E7%B4%A2%E5%BC%95%E8%AE%BE%E7%BD%AE"}},[s._v("索引设置")]),s._v("。")])])])])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("version")])]),s._v(" "),a("p",[s._v("（可选，整数）用于外部管理索引模板的版本号。Elasticsearch 不会自动生成此值。")])])]),s._v(" "),a("h2",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("h3",{attrs:{id:"带索引别名的索引模板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#带索引别名的索引模板"}},[s._v("#")]),s._v(" 带索引别名的索引模板")]),s._v(" "),a("p",[s._v("你可以在索引模板中包含"),a("a",{attrs:{href:"/rest_apis/index_apis/bulk_index_alias"}},[s._v("索引别名")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT _index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"te*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aliases"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"alias1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"alias2"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user.id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kimchy"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"routing"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shard-1"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{index}-alias"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("ul",[a("li",[a("code",[s._v('"{index}-alias" : {}')]),s._v("：在索引创建期间，别名中的 "),a("code",[s._v("{index}")]),s._v(" 占位符将替换为模板应用到的实际索引名称。")])]),s._v(" "),a("h3",{attrs:{id:"多匹配模板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多匹配模板"}},[s._v("#")]),s._v(" 多匹配模板")]),s._v(" "),a("p",[s._v("如果多个索引模板与新索引或数据流的名称匹配，则使用具有最高优先级的模板。例如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"priority"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mappings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_source"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enabled"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nPUT /_index_template/template_2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"te*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"priority"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mappings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_source"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enabled"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[s._v("对于以 "),a("code",[s._v("te*")]),s._v(" 开头的索引，将启用 "),a("code",[s._v("_source")]),s._v("，索引将有两个主分片和一个副本，因为只会应用 "),a("code",[s._v("template_2")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("不允许有相同优先级且索引模式重合的多个模板，且在尝试创建一个模板，而它与现有索引模板匹配具有相同优先级时，将引发错误。")])]),s._v(" "),a("h3",{attrs:{id:"模板版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板版本"}},[s._v("#")]),s._v(" 模板版本")]),s._v(" "),a("p",[s._v("可以使用 "),a("code",[s._v("version")]),s._v(" 参数向索引模板添加版本号。外部系统可以使用这些版本号来简化模板管理。")]),s._v(" "),a("p",[a("code",[s._v("version")]),s._v(" 参数是可选的，Elasticsearch 不自动生成也不使用。")]),s._v(" "),a("p",[s._v("若要取消设置 "),a("code",[s._v("version")]),s._v("，请在不指定它的情况下替换模板。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"priority"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("为了检查 "),a("code",[s._v("version")]),s._v("，你可以使用"),a("a",{attrs:{href:"/rest_apis/index_apis/get_index_template"}},[s._v("获取索引模板")]),s._v(" API。")]),s._v(" "),a("h3",{attrs:{id:"模板元数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板元数据"}},[s._v("#")]),s._v(" 模板元数据")]),s._v(" "),a("p",[s._v("你可以使用 "),a("code",[s._v("_meta")]),s._v(" 参数向索引模板添加任意元数据。这个用户定义的对象存储在集群状态下，因此最好保持它内容简短。")]),s._v(" "),a("p",[a("code",[s._v("_meta")]),s._v(" 参数是可选的，Elasticsearch 不自动生成也不使用。")]),s._v(" "),a("p",[s._v("若要取消设置 "),a("code",[s._v("_meta")]),s._v("，请在不指定它的情况下替换模板。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_meta"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"set number of shards to three"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"serialization"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"class"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyIndexTemplate"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("为了检查 "),a("code",[s._v("_meta")]),s._v("，你可以使用"),a("a",{attrs:{href:"/rest_apis/index_apis/get_index_template"}},[s._v("获取索引模板")]),s._v(" API。")]),s._v(" "),a("h3",{attrs:{id:"数据流定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据流定义"}},[s._v("#")]),s._v(" 数据流定义")]),s._v(" "),a("p",[s._v("要对数据流使用索引模板，该模板必须包含 "),a("code",[s._v("data_stream")]),s._v(" 对象。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"logs-*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data_stream"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("参阅"),a("a",{attrs:{href:"/data_streams/set_up_a_data_stream/set_up_a_data_stream#%E7%AC%AC-3-%E6%AD%A5.%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E6%A8%A1%E6%9D%BF"}},[s._v("创建索引模板")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"合并别名、映射和设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合并别名、映射和设置"}},[s._v("#")]),s._v(" 合并别名、映射和设置")]),s._v(" "),a("p",[s._v("当在索引模板的 "),a("code",[s._v("composed_of")]),s._v(" 字段中指定多个组件模板时，它们将按指定的顺序合并，这意味着后面的组件模板覆盖早期的组件模板。下一步将合并父索引模板中的任何映射、设置或别名。最后，将合并索引请求本身的任何配置。")]),s._v(" "),a("p",[s._v("在本例中，两个组件模板的顺序会更改索引的分片数：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /_component_template/template_with_2_shards\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.number_of_shards"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nPUT /_component_template/template_with_3_shards\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.number_of_shards"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nPUT /_index_template/template_1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_patterns"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"composed_of"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template_with_2_shards"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template_with_3_shards"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("在这种情况下，匹配 "),a("code",[s._v("t*")]),s._v(" 的索引将有三个主分片。如果组合模板的顺序颠倒，索引将有两个主分片。")]),s._v(" "),a("p",[s._v("映射定义递归合并，这意味着以后的映射组件可以引入新的字段映射并更新映射配置。如果一个字段映射已经包含在早期组件中，那么它的定义将被后面的组件完全覆盖。")]),s._v(" "),a("p",[s._v("这种递归合并策略不仅适用于字段映射，还适用于根选项，如 "),a("code",[s._v("dynamic_templates")]),s._v(" 和 "),a("code",[s._v("meta")]),s._v("。如果早期组件包含 "),a("code",[s._v("dynamic_templates")]),s._v(" 块，则默认情况下，新的 "),a("code",[s._v("dynamic_templates")]),s._v(" 条目将附加到末尾。如果已经存在具有相同键的条目，则该条目将被新定义覆盖。")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-put-template.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);