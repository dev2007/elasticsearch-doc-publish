(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{374:function(s,a,t){"use strict";t.r(a);var n=t(13),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"字段能力-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字段能力-api"}},[s._v("#")]),s._v(" 字段能力 API")]),s._v(" "),a("p",[s._v("允许你在多个索引中检索字段的功能。对于数据流，API 返回流的支持索引中的字段功能。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET /_field_caps?fields"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rating\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[s._v("#")]),s._v(" 请求")]),s._v(" "),a("p",[a("code",[s._v("GET /_field_caps?fields=<fields>")])]),s._v(" "),a("p",[a("code",[s._v("POST /_field_caps?fields=<fields>")])]),s._v(" "),a("p",[a("code",[s._v("GET /<target>/_field_caps?fields=<fields>")])]),s._v(" "),a("p",[a("code",[s._v("POST /<target>/_field_caps?fields=<fields>")])]),s._v(" "),a("h2",{attrs:{id:"前置条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[s._v("#")]),s._v(" 前置条件")]),s._v(" "),a("ul",[a("li",[s._v("如果 Elasticsearch 安全特性启用，你必须对目标数据流、索引或别名有 "),a("code",[s._v("view_index_metadata")]),s._v("、"),a("code",[s._v("read")]),s._v(" 或 "),a("code",[s._v("manage")]),s._v(" "),a("a",{attrs:{href:"/secure_the_elastic_statck/user_authorization/security_privileges#%E7%B4%A2%E5%BC%95%E6%9D%83%E9%99%90"}},[s._v("索引权限")]),s._v("。")])]),s._v(" "),a("h2",{attrs:{id:"描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[s._v("#")]),s._v(" 描述")]),s._v(" "),a("p",[s._v("字段能力 API 在多个索引中返回有关字段功能的信息。")]),s._v(" "),a("p",[s._v("字段能力 API 像任何其他字段一样返回"),a("a",{attrs:{href:"/mapping/runtime_fields/runtime_fields"}},[s._v("运行时字段")]),s._v("。例如，具有 "),a("code",[s._v("keyword")]),s._v(" 类型的运行时字段将作为属于 "),a("code",[s._v("keyword")]),s._v(" 族的任何其他字段返回。")]),s._v(" "),a("h2",{attrs:{id:"路径参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路径参数"}},[s._v("#")]),s._v(" 路径参数")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("<target>")]),s._v("\n（可选，字符串）限制请求的逗号分隔的数据流、索引和别名的列表。支持通配符（*）。要以所有数据流和索引为目标，忽略此参数或使用 "),a("code",[s._v("*")]),s._v(" 或 "),a("code",[s._v("_all")]),s._v("。")])]),s._v(" "),a("h2",{attrs:{id:"查询参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询参数"}},[s._v("#")]),s._v(" 查询参数")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("fields")]),s._v("\n（必需，字符串）以逗号分隔的待返回能力的字段列表，用于检索功能。支持通配符（*）表达式。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("allow_no_indices")]),s._v("\n（可选，布尔值）如果为 "),a("code",[s._v("false")]),s._v("，任何通配符、"),a("a",{attrs:{href:"/rest_apis/index_apis/bulk_index_alias"}},[s._v("索引别名")]),s._v("或 "),a("code",[s._v("_all")]),s._v(" 值只针对丢失或关闭的索引，请求将返回一个错误。即使请求以其他开启索引为目标，此行为也适用。例如，如果一个索引以 "),a("code",[s._v("foo")]),s._v(" 开头，而没有索引以 "),a("code",[s._v("bar")]),s._v(" 开头，则以 "),a("code",[s._v("foo*,bar*")]),s._v(" 为目标的请求将返回错误。")]),s._v(" "),a("p",[s._v("默认为 "),a("code",[s._v("true")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("expand_wildcards")]),s._v("\n（可选，字符串）通配符表达式可以匹配的索引类型。如果请求可以数据流为目标，则此参数确定通配符表达式是否匹配隐藏的数据流。支持逗号分隔的值，如 "),a("code",[s._v("open,hidden")]),s._v("。有效的值有：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("all")]),s._v("\n匹配任何数据流或索引，包括 "),a("a",{attrs:{href:"/rest_apis/api_convention/multi_target_syntax#%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E6%B5%81%E5%92%8C%E7%B4%A2%E5%BC%95"}},[s._v("hidden")]),s._v("（隐藏的）。")]),s._v(" "),a("li",[a("code",[s._v("open")]),s._v("\n匹配 open（开启）、非隐藏的索引。也匹配任何非隐藏的数据流。")]),s._v(" "),a("li",[a("code",[s._v("closed")]),s._v("\n匹配 closed（关闭）、非隐藏的索引。也匹配任何非隐藏的数据流。数据流不能关闭。")]),s._v(" "),a("li",[a("code",[s._v("hidden")]),s._v("\n匹配隐藏数据流和隐藏索引。必须与 "),a("code",[s._v("open")]),s._v("、"),a("code",[s._v("closed")]),s._v(" 或一起使用。")]),s._v(" "),a("li",[a("code",[s._v("none")]),s._v("\n不接受通配符表达式。")])]),s._v(" "),a("p",[s._v("默认为 "),a("code",[s._v("open")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ignore_unavailable")]),s._v("\n（可选，布尔值）如果为 "),a("code",[s._v("true")]),s._v("，缺少或关闭的索引不包括在响应中。默认为 "),a("code",[s._v("false")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("include_unmapped")]),s._v("\n（可选，布尔值）如果为 "),a("code",[s._v("true")]),s._v("，响应中包含未映射的字段。默认为 "),a("code",[s._v("false")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("filters")]),s._v("\n（可选，字符串）用于响应的逗号分隔过滤器列表。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("filters")]),s._v(" 有效值：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("+metadata")]),s._v("\n仅包含 metadata 字段")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-metadata")]),s._v("\n排除 metadata 字段")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-parent")]),s._v("\n排除 parent 字段")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-nested")]),s._v("\n排除 nested 字段")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-multifield")]),s._v("\n排除 multifield 字段")])])])])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("types")]),s._v("\n（可选，字符串）逗号分隔的要包含的字段类型的列表。任何与这些类型之一不匹配的字段都将从结果中排除。默认为空，表示返回所有字段类型。参阅"),a("a",{attrs:{href:"/rest_apis/search_api/field_capabilities#%E5%93%8D%E5%BA%94%E4%BD%93"}},[s._v("此处")]),s._v("，了解有关字段能力请求和响应中字段类型的更多信息。")])])]),s._v(" "),a("h2",{attrs:{id:"请求体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求体"}},[s._v("#")]),s._v(" 请求体")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("index_filter")]),s._v("\n（可选，"),a("a",{attrs:{href:"/query_dsl/query_dsl"}},[s._v("查询对象")]),s._v("）如果提供的查询重写为在每个分片上 "),a("code",[s._v("match_none")]),s._v("，则允许筛选索引。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("runtime_mappings")]),s._v("\n（可选，对象）在请求中定义临时"),a("a",{attrs:{href:"/mapping/define_runtime_fields_in_a_search_request"}},[s._v("运行时字段")]),s._v("，类似于在"),a("a",{attrs:{href:"/rest_apis/search_apis/search"}},[s._v("搜索请求")]),s._v("中执行的方式。这些字段仅作为查询的一部分存在，并且优先于在索引映射中使用相同名称定义的字段。")])])]),s._v(" "),a("h2",{attrs:{id:"响应体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应体"}},[s._v("#")]),s._v(" 响应体")]),s._v(" "),a("p",[s._v("响应中使用的类型描述了字段类型"),a("em",[s._v("族（families）")]),s._v("。通常，类型族与映射中声明的字段类型相同，但为了简化问题，某些行为相同的字段类型使用类型族进行描述。例如，"),a("code",[s._v("keyword")]),s._v("、"),a("code",[s._v("constant_keyword")]),s._v(" 和 "),a("code",[s._v("wildcard")]),s._v(" 字段类型都被描述为 "),a("code",[s._v("keyword")]),s._v(" 类型族。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("metadata_field")]),s._v("\n该字段是否注册为 "),a("a",{attrs:{href:"/mapping/metadata_fields"}},[s._v("metadata 字段")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("searchable")]),s._v("\n该字段是否在所有索引中都可搜索")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("aggregatable")]),s._v("\n该字段是否在所有索引中都可聚合")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("time_series_dimension")]),s._v("\n[预览]该字段是否为时序维度")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("time_series_metric")]),s._v("\n[预览]如果此字段用作时序度量，则包含度量类型；如果此字段未用作度量，则不包含。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("indices")]),s._v("\n此字段具有相同类型族的索引列表，如果所有索引都具有该字段的相同类型族，则为 null。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("non_searchable_indices")]),s._v("\n此字段不可搜索的索引列表，如果所有索引对该字段具有相同的定义，则为 null。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("non_aggregatable_indices")]),s._v("\n此字段不可聚合的索引列表，如果所有索引对该字段具有相同的定义，则为 null。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("non_dimension_indices")]),s._v("\n[预览]此字段不可聚合的索引列表，如果所有索引对该字段具有相同的定义，则为null。如果有此列表作为响应，则某些索引将字段标记为维度，而其他索引（此列表中的索引）则没有。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("metric_conflicts_indices")]),s._v("\n[预览]如果此字段的索引没有相同的 "),a("code",[s._v("time_series_metric")]),s._v(" 值，则显示此字段的索引列表。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("meta")]),s._v("\n将所有索引中的元数据合并为字符串键到值数组的映射。值长度为1表示所有索引对此键具有相同的值，而长度为 2 或更多表示并非所有索引对此键具有相同的值。")])])]),s._v(" "),a("h2",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("请求可以限制为特定的数据流和索引：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET my-index-000001/_field_caps?fields"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rating\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("下一个示例 API 调用请求有关 "),a("code",[s._v("rating")]),s._v(" 和 "),a("code",[s._v("title")]),s._v(" 字段的信息：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET _field_caps?fields"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rating,title\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("此 API 返回以下响应：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index2"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index5"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fields"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rating"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"long"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index2"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"non_aggregatable_indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"non_searchable_indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("ol",[a("li",[a("code",[s._v('"rating": {')]),s._v("：字段 "),a("code",[s._v("rating")]),s._v(" 在 "),a("code",[s._v("index1")]),s._v(" 和 "),a("code",[s._v("index2")]),s._v(" 中定义为长，在 "),a("code",[s._v("index3")]),s._v(" 和 "),a("code",[s._v("index4")]),s._v(" 中定义为 "),a("code",[s._v("keyword")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v('"non_aggregatable_indices": [ "index1" ]')]),s._v("：字段 "),a("code",[s._v("rating")]),s._v(" 在索引 "),a("code",[s._v("index1")]),s._v(" 中无聚合。")]),s._v(" "),a("li",[a("code",[s._v('"non_searchable_indices": [ "index4" ]')]),s._v("：字段 "),a("code",[s._v("rating")]),s._v(" 在索引 "),a("code",[s._v("index4")]),s._v(" 中无法搜索。")]),s._v(" "),a("li",[a("code",[s._v('"title": {')]),s._v("：字段 "),a("code",[s._v("title")]),s._v(" 在所有索引中定义为 "),a("code",[s._v("text")]),s._v("。")])]),s._v(" "),a("p",[s._v("默认情况下，将忽略未映射的字段。通过在请求中添加一个名为 "),a("code",[s._v("include_unmapped")]),s._v(" 的参数，可以将它们包括在响应中：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET _field_caps?fields"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rating,title"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("include_unmapped\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在这种情况下，响应将包含某些索引（但不是所有索引）中存在的每个字段的条目：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index2"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fields"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rating"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"long"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index2"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"non_aggregatable_indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"non_searchable_indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unmapped"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index5"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index1"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index2"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unmapped"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metadata_field"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indices"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index5"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"searchable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggregatable"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("ol",[a("li",[s._v("第一个 "),a("code",[s._v('"unmapped": {')]),s._v("：字段 "),a("code",[s._v("rating")]),s._v(" 在索引 "),a("code",[s._v("index5")]),s._v(" 中无映射。")]),s._v(" "),a("li",[s._v("第二个 "),a("code",[s._v('"unmapped": {')]),s._v("：字段 "),a("code",[s._v("title")]),s._v(" 在索引 "),a("code",[s._v("index5")]),s._v(" 中无映射。")])]),s._v(" "),a("p",[s._v("还可以通过查询过滤索引：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST my-index-*/_field_caps?fields"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rating\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_filter"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"range"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@timestamp"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gte"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("在这种情况下的索引，将从响应中筛选提供的过滤器，在每个分片上重写为 "),a("code",[s._v("match_none")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("过滤是在尽力而为的基础上完成的，它使用索引统计信息和映射来重写查询为 "),a("code",[s._v("match_none")]),s._v("，而不是完全执行请求。例如，如果分片中的所有文档（包括已删除的文档）都不在提供的范围内，则对 "),a("code",[s._v("date")]),s._v(" 字段的 "),a("code",[s._v("range")]),s._v(" 查询可以重写为 "),a("code",[s._v("match_none")]),s._v("。但是，并非所有查询都可以重写为 "),a("code",[s._v("match_none")]),s._v("，因此即使提供的筛选器不匹配任何文档，该 API 也可能返回索引。")])]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-field-caps.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);