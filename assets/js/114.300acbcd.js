(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{392:function(e,_,t){"use strict";t.r(_);var a=t(13),s=Object(a.a)({},(function(){var e=this,_=e._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"审计安全设置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#审计安全设置"}},[e._v("#")]),e._v(" 审计安全设置")]),e._v(" "),_("p",[e._v("你可以使用"),_("a",{attrs:{href:"/secure_the_elastic_stack/enable_audit_logging/enable_audit_logging"}},[e._v("审计日志")]),e._v("记录与安全相关的事件，例如身份验证失败、拒绝连接和数据访问事件。此外，通过 API 对安全配置的更改，例如创建、更新和删除"),_("a",{attrs:{href:"/secure_the_elastic_stack/user_authentication/native_user_authentication"}},[e._v("本机")]),e._v("和"),_("a",{attrs:{href:"/secure_the_elastic_stack/user_authentication/built_in_users"}},[e._v("内置")]),e._v("用户、"),_("a",{attrs:{href:"/rest_apis/security_apis/create_or_update_roles"}},[e._v("角色")]),e._v("、"),_("a",{attrs:{href:"/rest_apis/security_apis/create_or_update_role_mappings"}},[e._v("角色映射")]),e._v("和 "),_("a",{attrs:{href:"/rest_apis/security_apis/create_api_keys"}},[e._v("API 键")]),e._v("也会被记录下来。")]),e._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[e._v("提示")]),e._v(" "),_("p",[e._v("审计日志仅在某些订阅级别上可用。欲了解更多信息，参阅 "),_("a",{attrs:{href:"https://www.elastic.co/subscriptions",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.elastic.co/subscriptions"),_("OutboundLink")],1),e._v("。")])]),e._v(" "),_("p",[e._v("如果配置了，则必须在集群中的每个节点上设置审计设置。静态设置，例如 "),_("code",[e._v("xpack.security.audit.enabled")]),e._v("，必须在每个节点的 "),_("code",[e._v("elasticsearch.yml")]),e._v(" 中配置。对于动态审计设置，使用"),_("a",{attrs:{href:"/rest_apis/cluster_apis/cluster_update_settings"}},[e._v("集群更新设置 API")]),e._v("确保所有节点上的设置相同。")]),e._v(" "),_("h2",{attrs:{id:"常规审计设置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#常规审计设置"}},[e._v("#")]),e._v(" 常规审计设置")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("xpack.security.audit.enabled")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("静态")]),e._v(")设置为 "),_("code",[e._v("true")]),e._v("，启用对节点的审计。默认值为 "),_("code",[e._v("false")]),e._v("。这将把审计事件放在一个名为 "),_("code",[e._v("<clustername>_audit.json")]),e._v(" 的专用文件中。")]),e._v(" "),_("p",[e._v("如果启用，则必须在 "),_("code",[e._v("elasticsearch.yml")]),e._v(" 中配置此设置。在集群中的所有节点上使用。")])])]),e._v(" "),_("h2",{attrs:{id:"审计事件设置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#审计事件设置"}},[e._v("#")]),e._v(" 审计事件设置")]),e._v(" "),_("p",[e._v("可以通过使用以下设置来控制记录的事件和其他信息:")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.include")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")指定要在审计输出中打印的"),_("a",{attrs:{href:"/secure_the_elastic_stack/enable_audit_logging/audit_events"}},[e._v("事件类型")]),e._v("。此外，"),_("code",[e._v("_all")]),e._v(" 可以用于详尽地审计所有事件，但通常不建议这样做，因为它会变得非常冗长。默认列表值包括："),_("code",[e._v("access_denied")]),e._v("、"),_("code",[e._v("access_granted")]),e._v("、"),_("code",[e._v("anonymous_access_denied")]),e._v("、"),_("code",[e._v("authentication_failed")]),e._v("、"),_("code",[e._v("connection_denied")]),e._v("、"),_("code",[e._v("tampered_request")]),e._v("、"),_("code",[e._v("run_as_denied")]),e._v("、"),_("code",[e._v("run_as_granted")]),e._v("、"),_("code",[e._v("security_config_change")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.exclude")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")从包含列表中排除指定"),_("a",{attrs:{href:"/secure_the_elastic_stack/enable_audit_logging/audit_events"}},[e._v("事件类型")]),e._v("。这在事件的情况下很有用。包含设置包含特殊值 "),_("code",[e._v("_all")]),e._v("。默认是空列表。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.emit_request_body")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")指定是否将来自 REST 请求的完整请求体作为某些类型的审计事件的属性。此设置可用于"),_("a",{attrs:{href:"/secure_elastic_stack/enable_audit_logging/auditing_search_queries"}},[e._v("审计搜索查询")]),e._v("。")]),e._v(" "),_("p",[e._v("默认值为 "),_("code",[e._v("false")]),e._v("，因此不打印请求体。")])])]),e._v(" "),_("div",{staticClass:"custom-block danger"},[_("p",{staticClass:"custom-block-title"},[e._v("重要")]),e._v(" "),_("p",[e._v("当在审计事件中包含请求体时，建议可能会以纯文本的形式审计敏感数据，即使所有安全 API(如更改用户密码的 API)在审计时都会过滤掉凭据。")])]),e._v(" "),_("h2",{attrs:{id:"本地节点信息设置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#本地节点信息设置"}},[e._v("#")]),e._v(" 本地节点信息设置")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.emit_node_name")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")是否在每个审计事件中包含"),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch/import_elasticsearch_configuration#%E8%8A%82%E7%82%B9%E5%90%8D%E8%AE%BE%E7%BD%AE"}},[e._v("节点名")]),e._v("字段。默认值为 "),_("code",[e._v("false")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.emit_node_host_address")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")在每个审计事件中是否包含节点的 IP 地址作为字段。默认值为 "),_("code",[e._v("false")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.emit_node_host_name")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")是否在每个审计事件中包含节点的主机名作为字段。默认值为 "),_("code",[e._v("false")]),e._v("。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.emit_node_id")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")是否在每个审计事件中包含节点id字段。节点名称的值可能在管理员更改配置文件中的设置时发生变化，与节点名称不同的是，节点 id 将在集群重新启动时保持不变，管理员不能更改它。缺省值为 "),_("code",[e._v("true")]),e._v("。")])])]),e._v(" "),_("h2",{attrs:{id:"审计日志文件事件忽略策略"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#审计日志文件事件忽略策略"}},[e._v("#")]),e._v(" 审计日志文件事件忽略策略")]),e._v(" "),_("p",[e._v("以下设置影响"),_("a",{attrs:{href:"/secure_the_elastic_stack/enable_audit_logging/logfile_audit_events_ignore_policies"}},[e._v("忽略策略")]),e._v("，这些策略支持对哪些审计事件打印到日志文件进行细粒度控制。具有相同策略名称的所有设置组合在一起形成单一策略。如果一个事件匹配任何策略的所有条件，它将被忽略并且不打印。大多数审计事件服从于忽略策略。唯一的例外是 "),_("code",[e._v("security_config_change")]),e._v(" 类型的事件，它不能被过滤掉，除非完全"),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch/auditing_settings#%E5%AE%A1%E8%AE%A1%E4%BA%8B%E4%BB%B6%E8%AE%BE%E7%BD%AE"}},[e._v("排除")]),e._v("。")]),e._v(" "),_("ul",[_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.ignore_filters.<policy_name>.users")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")用户名或通配符的列表。指定的策略将不会打印匹配这些值的用户的审计事件。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.ignore_filters.<policy_name>.realms")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")认证领域名称或通配符的列表。指定的策略将不会为这些域中的用户打印审计事件。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.ignore_filters.<policy_name>.actions")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")操作名或通配符的列表。操作名可以在审计事件的 "),_("code",[e._v("action")]),e._v(" 字段中找到。指定的策略将不会为匹配这些值的操作打印审计事件。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.ignore_filters.<policy_name>.roles")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")角色名或通配符的列表。指定的策略将不会为具有这些角色的用户打印审计事件。如果用户有多个角色，其中一些角色"),_("strong",[e._v("不")]),e._v("在策略中覆盖，则策略将"),_("strong",[e._v("不")]),e._v("覆盖此事件。")])]),e._v(" "),_("li",[_("p",[_("code",[e._v("xpack.security.audit.logfile.events.ignore_filters.<policy_name>.indices")])]),e._v(" "),_("p",[e._v("("),_("a",{attrs:{href:"/set_up_elasticsearch/configuring_elasticsearch"}},[e._v("动态")]),e._v(")索引名或通配符的列表。当事件中的所有索引都匹配这些值时，指定的策略将不打印审计事件。如果事件涉及多个索引，其中一些不在策略覆盖范围内，则策略将"),_("strong",[e._v("不")]),e._v("覆盖此事件。")])])]),e._v(" "),_("blockquote",[_("p",[_("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/auditing-settings.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("原文链接"),_("OutboundLink")],1)])])])}),[],!1,null,null,null);_.default=s.exports}}]);